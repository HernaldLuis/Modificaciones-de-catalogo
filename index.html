<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cat√°logo de Habitaciones</title>
  <style>

/* === Inventario: Bot√≥n premium & Modal PIN elegante === */
.boton-inventario{
  display:inline-flex; align-items:center; gap:.55rem;
  padding:.6rem 1rem; border-radius:999px;
  font: 600 14px/1 'Playfair Display', Georgia, 'Times New Roman', serif;
  color:#fff; background:linear-gradient(135deg,#c9a14a,#8a5a2b);
  border:1px solid rgba(255,255,255,.22);
  box-shadow:0 10px 25px rgba(138,90,43,.35), inset 0 1px 0 rgba(255,255,255,.25);
  backdrop-filter:saturate(180%) blur(4px);
  cursor:pointer; transition:transform .15s ease, box-shadow .2s ease, filter .2s ease;
}
.boton-inventario:hover{ transform:translateY(-1px); filter:brightness(1.05); box-shadow: 0 16px 30px rgba(138,90,43,.45); }
.boton-inventario:active{ transform:translateY(0); box-shadow: 0 6px 16px rgba(138,90,43,.35); }
.boton-inventario::before{
  content:"üßæ"; font-size:16px; line-height:1; margin-right:.1rem;
}
.hkpin2-overlay{
  display:none; position:fixed; inset:0; z-index:100000;
  background: radial-gradient(1200px 800px at 70% 20%, rgba(37,117,252,.18), transparent 60%),
              rgba(0,0,0,.55);
  backdrop-filter: blur(3px);
  align-items:center; justify-content:center;
}
.hkpin2{
  width:min(92vw, 380px);
  background: linear-gradient(180deg,#ffffff, #f7f9ff);
  border:1px solid rgba(0,0,0,.06);
  border-radius:16px; padding:18px 16px 14px;
  box-shadow: 0 24px 60px rgba(0,0,0,.35);
  animation: hkpin2In .25s ease;
}
@keyframes hkpin2In{ from{ transform:translateY(8px); opacity:0;} to{ transform:none; opacity:1;} }
.hkpin2 h3{ margin:0 0 4px; font-size:18px; font-weight:800; letter-spacing:.2px; }
.hkpin2 .sub{ margin:0 0 12px; color:#556; font-size:13px; }
.hkpin2 .row{ display:flex; gap:8px; align-items:center; margin:8px 0 14px; }
.hkpin2-input{
  flex:1; padding:12px; border-radius:12px; border:1px solid rgba(0,0,0,.12);
  outline:none; font-size:16px; background:#fff; box-shadow: inset 0 1px 2px rgba(0,0,0,.06);
}
.hkpin2-toggle{ padding:11px 12px; border-radius:12px; border:1px solid rgba(0,0,0,.12); background:#f2f4ff; cursor:pointer; }
.hkpin2-actions{ display:flex; justify-content:flex-end; gap:8px; }
.hkbtn{ padding:.6rem .95rem; border-radius:12px; border:1px solid rgba(0,0,0,.1); background:#fff; cursor:pointer; font-weight:600; }
.hkbtn.primary{ background:linear-gradient(135deg,#6a11cb,#2575fc); color:#fff; border:none; }
.hkbtn.primary:hover{ filter:brightness(1.03); }
.hkbtn:disabled{ opacity:.6; cursor:not-allowed; }



/* Toolbar dentro del panel de detalle */
.modal-toolbar{display:flex;gap:.5rem;align-items:center;margin:.5rem 0 1rem;flex-wrap:wrap}
.btn{padding:.45rem .8rem;border-radius:.6rem;border:1px solid rgba(0,0,0,.12);background:#fff;cursor:pointer;box-shadow:0 1px 2px rgba(0,0,0,.08);}
.btn.hk{font-weight:700;}
.btn:hover{filter:brightness(0.98);}


body {
  margin: 0;
  font-family: Arial, sans-serif;
  background-image: url('https://raw.githubusercontent.com/HernaldLuis/Catalogo-Paradisus-Habitaciones/main/Portada.jpeg');
  background-size: cover;
  background-position: center;
  background-color: #f0f0f0; /* fallback si la imagen no carga */
 } 
    h1 {
      text-align: center;
      padding: 20px;
 }

.btn-volver {
  display: inline-block;
  padding: 8px 14px;
  background: linear-gradient(135deg, #6b4226, #a47148); /* Tonos tierra */
  color: white;
  font-weight: bold;
  text-transform: uppercase;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s ease-in-out;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
}

.btn-volver:hover {
  background: linear-gradient(135deg, #a47148, #6b4226);
  transform: scale(1.05);
}

.btn-volver:active {
  transform: scale(0.97);
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
}

.titulo-catalogo {
  display: flex;
  align-items: center;
  justify-content: center; /* Centra texto y logo */
  gap: 0.75rem;
  flex-wrap: wrap; /* Para que en m√≥vil no se corte raro */

  font-family: 'Playfair Display', serif;
  font-size: 2rem;
  font-weight: 700;
  letter-spacing: 0.5px;
  color: #111;
  text-align: center;
  margin: 1rem 0 1.5rem;
  text-shadow: 0 2px 4px rgba(0,0,0,0.25);
  position: relative;
}

.titulo-catalogo span {
  display: inline-block;
}

.titulo-catalogo::after {
  content: '';
  display: block;
  width: 90px;
  height: 3px;
  margin: 0.5rem auto 0;
  background: #111;
  border-radius: 2px;
  position: absolute;
  bottom: -0.5rem;
  left: 50%;
  transform: translateX(-50%);
}

.logo-catalogo {
  height: 90px; /* un poco m√°s grande */
  width: auto;
}


@media (max-width: 600px) {
  .logo-catalogo {
    height: 62px; /* sigue siendo m√°s grande que el texto pero no exagerado */
  }
}

  .zona-desplazable,
.zona-desplazable * {
  user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
}

.zona-desplazable {
  cursor: grab;

  touch-action: pan-x pinch-zoom;
  -webkit-overflow-scrolling: touch;
}

.zona-desplazable.arrastrando {
  cursor: grabbing;
}


.mensaje-inicial {
  text-align: center;
  font-weight: bold;
  font-size: 16px;
  color: #444;
  padding: 10px;
}

    .zona-desplazable {
      display: flex;
      flex-direction: row;
      gap: 40px;
      padding: 20px;
      overflow-x: auto;
      overflow-y: hidden;
      scroll-behavior: smooth;
background: transparent;  /* ¬°ESTE COMANDO HACE QUE EL CONTENEDOR DEL CROQUIS SEA TRASNPARENTE! */
border-top: none;
border-bottom: none;
      width: 100vw;
      box-sizing: border-box;
      white-space: nowrap;
    }

.torre {
  flex: 0 0 auto;
  width: max-content;
  min-width: 420px;
  display: flex;
  flex-direction: column;
  gap: 10px;
  background-color: rgba(0, 0, 0, 0.5); /* <- Fondo oscuro transparente */
  border-radius: 10px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  color: white; /* Para que el texto sea legible */
}

    .torre-2 {
  margin-top: 145px;
}

   .torre-3 {
  margin-top: 205px;
}

       .torre-4 {
  margin-top: 100px;

}

    .torre h2 {
      text-align: center;
      background: #005baa;
      color: white;
      margin: 0;
      padding: 10px;
      border-radius: 6px;
    }

  /* <-- ESTO ES EL PANEL INFERIOR DONDE METEMOS IMAGENES Y DESCRIPCION */
.panel-inferior {
  position: fixed;
  bottom: 30px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(255, 255, 255, 0.95);
  padding: 40px 50px;
  border-radius: 18px;
  box-shadow: 0 12px 28px rgba(0,0,0,0.35);
  z-index: 9999;
  display: none;
  max-width: 98vw;
  width: 1000px; /* antes 600px, luego 800px */
  color: black;
}


  .contenido-panel {
    position: relative;
  }

  .cerrar-panel {
    position: absolute;
    top: -15px;
    right: -15px;
    background: #ff4d4d;
    color: white;
    font-weight: bold;
    padding: 5px 12px;
    border-radius: 50%;
    cursor: pointer;
    box-shadow: 0 3px 6px rgba(0,0,0,0.2);
  }

  .galeria-imagenes {
    display: flex;
    gap: 10px;
    justify-content: center;
    margin-top: 15px;
    flex-wrap: wrap;
  }

  .galeria-imagenes img {
    width: 180px; /* ESTE TAMA√ëO CONTROLA LAS IMAGENES DEL PANEL DE CONSULTA */
    border-radius: 8px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
  }


.galeria-habitacion {
  display: flex;
  justify-content: center;
  gap: 15px;
  flex-wrap: wrap; /* esto permite que salten a otra fila */
  margin-top: 20px;
}

.bloque-imagen {
  text-align: center;
}

.bloque-imagen img {
  width: 280px; /* antes 200px ‚Üí luego 240px */
  border-radius: 10px;
  transition: transform 0.3s ease;
  cursor: zoom-in;
}

.bloque-imagen img:hover {
  transform: scale(1.2);
  z-index: 10;
}

#zoom-overlay {
  display: none; /* ser√° activado con JS */
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background-color: rgba(0, 0, 0, 0.7);
  justify-content: center;
  align-items: center;
  z-index: 11000;
}

#zoom-overlay img {
  max-width: 80%;
  max-height: 80%;
  border-radius: 12px;
  box-shadow: 0 0 25px rgba(255,255,255,0.3);
  transition: transform 0.3s ease;
}




#zoom-img {
  max-width: 90%;
  max-height: 80%;
  border-radius: 10px;
  box-shadow: 0 0 20px rgba(0,0,0,0.8);
  transition: transform 0.3s;
}

#zoom-close {
  position: absolute;
  top: 25px;
  right: 35px;
  font-size: 2rem;
  color: white;
  cursor: pointer;
  z-index: 10001;
}


.visor-oculto {
  display: none;
  position: fixed;
  top: 0; left: 0;
  width: 100vw;
  height: 100vh;
  background-color: rgba(0,0,0,0.85);
  justify-content: center;
  align-items: center;
  z-index: 99999;
}

.visor-oculto img {
  max-width: 90%;
  max-height: 90%;
  border-radius: 10px;
  box-shadow: 0 0 15px rgba(255,255,255,0.3);
  transition: transform 0.3s;
  cursor: zoom-out;
}



.piso {
  display: flex;
  gap: 5px;
  flex-wrap: nowrap; /* <-- evita que se baje */
   width: max-content;  /* ‚¨ÖÔ∏è esto fuerza a que se expanda lo necesario */
}

    .habitacion-btn {        
      padding: 6px 12px;
      background-color:#4caf50 ;   /*üî• Estas seccion cambiar el color de las habitaciones vacias*/
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
    }

    .habitacion-btn:hover {
      background-color: #388e3c ; /*üî• Estas seccion cambiar el color de las habitaciones cuando pones el cursor*/
    }

    .habitacion-btn.disponible {  background-color:#c79b3b; color:#fff; border: 2px solid rgba(255,255,255,.6); font-weight: bold; }

.habitacion-btn.disponible:hover { background-color: #a87f2d; }

    /* Tipo K - King */
.habitacion-btn.tipo-k {
  background-color: #6b9ac4;  /* Azul suave */
  border: 2px solid #3e5e8c;
}

/* Tipo D - Doble */
.habitacion-btn.tipo-d {
  background-color: #f4a261;  /* Naranja suave */
  border: 2px solid #b76b3d;
}


    .pasillo {
      width: 100%;
      border-top: 2px dashed #aaa;
      margin: 12px 0;
    }     

/* Estilo unificado para los bloques de ‚Äújard√≠n / pasillo‚Äù */
.jardin-simulada,
.jardin-ficticio {
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 380px;
  width: max-content;
  box-sizing: border-box;

  background: linear-gradient(to right, #d2b48c, #deb887, #f5deb3);
  color: #5c3a21;
  font-weight: bold;
  border: 2px dashed #c2a476;
  border-radius: 8px;
  margin-bottom: 8px;
  font-size: 14px;
  box-shadow: inset 0 0 5px rgba(92, 58, 33, 0.3),
              0 2px 6px rgba(0, 0, 0, 0.15);
  padding: 10px 40px 10px 10px; /* extra espacio en la derecha */
}

      /* (PANTALLA FLOTANTE) */
.mensaje-flotante {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background-color: rgba(0, 0, 0, 0.85);
  color: #fff;
  padding: 12px 24px;
  border-radius: 8px;
  font-size: 1rem;
  z-index: 9999;
  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
  animation: flotanteFadeIn 0.4s ease;
}

@keyframes flotanteFadeIn {
  from { opacity: 0; transform: translateX(-50%) translateY(20px); }
  to { opacity: 1; transform: translateX(-50%) translateY(0); }
}

.contenido-inferior {
  max-width: 100%;
  overflow-wrap: break-word; /* fuerza salto de l√≠nea si es necesario */
  word-wrap: break-word;
  white-space: normal; /* permite el salto de l√≠nea */
  font-size: 1.1rem;
  line-height: 1.6;
  padding: 10px;
}

.contenido-inferior a {
  display: inline;
  word-break: break-word;
}


.conector-conectadas {
  display: inline-block;
  color: white;            /* Color blanco */
  font-size: 12px;         /* M√°s corta visualmente */
  font-weight: bold;
  margin: 0 2px;           /* Muy poco espacio entre botones */
  line-height: 30px;       /* Alineaci√≥n vertical */
  pointer-events: none;    /* No clickeable, solo visual */
}

  .habitacion-btn .tipo-cama {   /* (Controla la letra por el tipo de cama de cada habitacion*/
  display: block;
  font-size: 12px;
  font-weight: normal;
  color: #f0f0f0;
  margin-top: 2px;
}

  .habitacion-btn div {
  line-height: 1.2;
}

.habitacion-btn div:nth-child(2) {
  font-size: 0.75rem;
  margin-top: 2px;
  opacity: 0.85;
}

/* ==== Panel de Filtro Categor√≠as - Estilo Premium ==== */
/* === PANEL DE FILTRO POR CATEGOR√çA - ULTRA PREMIUM === */
.panel-filtro-categoria {
  position: sticky;
  top: 0;
  z-index: 100;
  display: flex;
  gap: 1rem;
  align-items: center;
  flex-wrap: wrap;
  padding: 0.9rem 1.5rem;

  background: rgba(255, 255, 255, 0.8);
  background: linear-gradient(135deg, rgba(255,255,255,0.85), rgba(245,245,245,0.85));
  backdrop-filter: blur(10px) saturate(180%);
  border-bottom: 1px solid rgba(255, 255, 255, 0.3);
  border-radius: 0 0 18px 18px;

  box-shadow: 0 4px 20px rgba(0,0,0,0.08);
}

/* Etiqueta */
.panel-filtro-categoria label {
  font-weight: 600;
  font-size: 0.95rem;
  color: #333;
  letter-spacing: 0.5px;
}

/* Select elegante */
.panel-filtro-categoria select {
  padding: 0.45rem 1.2rem;
  font-size: 0.95rem;
  font-weight: 500;
  color: #333;
  border: 1px solid rgba(0,0,0,0.1);
  border-radius: 10px;
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(4px);
  box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
  transition: all 0.3s ease;
}
.panel-filtro-categoria select:hover {
  border-color: #00aaff;
  box-shadow: 0 0 8px rgba(0,170,255,0.3);
}
.panel-filtro-categoria select:focus {
  outline: none;
  border-color: #0077cc;
  box-shadow: 0 0 12px rgba(0,119,204,0.4);
}

/* Bot√≥n Limpiar */
.panel-filtro-categoria button {
  padding: 0.45rem 1.2rem;
  font-size: 0.9rem;
  font-weight: 600;
  color: #fff;
  background: linear-gradient(135deg, #00aaff, #0077cc);
  border: none;
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.3s ease;
}
.panel-filtro-categoria button:hover {
  background: linear-gradient(135deg, #0099dd, #0066aa);
  box-shadow: 0 4px 12px rgba(0,170,255,0.4);
}

/* Contador */
.panel-filtro-categoria .contador-categoria {
  margin-left: auto;
  font-size: 0.9rem;
  font-weight: 500;
  color: #444;
}
.panel-filtro-categoria .contador-categoria strong {
  color: #0077cc;
}

/* Animaci√≥n de habitaciones activas */
.habitacion-btn.filtro-activo {
  animation: boomCategoria .35s ease, latidoHabitacion 1.4s ease-in-out .35s infinite;
  will-change: transform, box-shadow;
  border-radius: 8px;
}
.habitacion-btn.filtro-inactivo {
  opacity: 0.28;
  filter: grayscale(.2) brightness(0.8);
}
@keyframes boomCategoria {
  0% { transform: scale(1); }
  60% { transform: scale(1.1); }
  100% { transform: scale(1); }
}
@keyframes latidoHabitacion {
  0%, 100% {
    transform: scale(1);
    box-shadow: 0 0 0 rgba(0,170,255,0);
  }
  50% {
    transform: scale(1.06);
    box-shadow: 0 0 16px rgba(0,170,255,0.45);
  }
}
/* Fondo oscuro */
.modal-mejoras {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 999;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease;
}

/* Activo */
.modal-mejoras.activo {
  opacity: 1;
  pointer-events: all;
}

/* Caja del modal */
.modal-contenido{
  box-sizing: border-box;
  background: #fff;
  padding: 1.25rem;
  border-radius: 12px;
  max-width: min(92vw, 520px);
  width: calc(100% - 2rem);
  box-shadow: 0 8px 20px rgba(0,0,0,0.25);
  text-align: left;
  overflow-wrap: anywhere;
  word-break: break-word;
  white-space: normal;
  animation: aparecerModal .4s ease;
}

.modal-contenido ul { margin: 0 0 .5rem; padding-left: 1.1rem; }
.modal-contenido li { margin-bottom: .35rem; }

@media (max-width: 480px) {
  
}

/* T√≠tulo */
.modal-contenido h2 {
  font-family: 'Playfair Display', serif; /* si la quieres, si no, qu√≠tala */
  font-size: 1.4rem;
  margin-bottom: 1rem;

  /* üëâ a√±ade: */
  line-height: 1.3;
  text-align: center;
  overflow-wrap: anywhere;   /* evita desborde por palabras/largos */
  word-break: break-word;    /* respaldo para navegadores viejos */
}

/* Lista */
.modal-contenido ul {
  padding-left: 1.2rem;
  margin-bottom: 1.5rem;
}
.modal-contenido li {
  margin-bottom: 0.5rem;
}

/* Bot√≥n */
.modal-contenido button {
  background: linear-gradient(135deg, #00aaff, #0077cc);
  color: #fff;
  border: none;
  padding: 0.5rem 1.2rem;
  border-radius: 8px;
  cursor: pointer;
  font-weight: 600;
}
.modal-contenido button:hover {
  background: linear-gradient(135deg, #0099dd, #0066aa);
}

/* Animaci√≥n */
@keyframes aparecerModal {
  0% { transform: scale(0.8); opacity: 0; }
  100% { transform: scale(1); opacity: 1; }
}

  /* (ESTO CORRESPNDE AL PANEL DE LAS IMAGENES DE COSULTa */

  
/* === Anexos (no altera tu estilo base) === */
.panel-filtro-categoria .chk {
  display: inline-flex; align-items: center; gap: .35rem;
  padding: 4px 6px; border-radius: 8px; background: rgba(255,255,255,0.6);
}
.totales-tabla table{
  width: 100%; border-collapse: collapse; background: rgba(255,255,255,0.88);
  border-radius: 12px; overflow: hidden; box-shadow: 0 4px 14px rgba(0,0,0,.08);
}
.totales-tabla th, .totales-tabla td{
  padding: .5rem .7rem; border-bottom: 1px solid rgba(0,0,0,.06); text-align: center;
}
.totales-tabla thead th{ background: linear-gradient(135deg, #00aaff22, #0077cc22); font-weight: 700; }
.totales-tabla tbody tr:last-child td{ border-bottom: 0; }

/* --- Video en detalle de habitaci√≥n (handicap) --- */
.video-habitacion{ position:absolute; top:16px; right:16px; width:520px; max-width:44%; background:#fff; border-radius:12px; box-shadow:0 12px 30px rgba(0,0,0,.18); overflow:hidden; }
07.77%); background:#000; } /* 16:9 */
.video-ratio iframe, .video-ratio video{ position:absolute; inset:0; width:100%; height:100%; border:0; object-fit:contain; }
.video-ratio video{ object-fit: contain; background:#000; }
.contenido-inferior{ position:relative; }
.contenido-inferior.con-video{ padding-right: calc(var(--video-width, 360px) + 24px); transition: padding-right .2s ease; } /* tarjeta blanca del detalle */
@media (max-width: 900px){
  .contenido-inferior.con-video{ padding-right:0; }
  .video-habitacion{ position:static; width:100%; max-width:100%; margin-bottom:12px; }
}


/* === Zoom de video === */
.video-zoom-overlay{
  display:none; position:fixed; inset:0; z-index:10000;
  background:rgba(0,0,0,.85); align-items:center; justify-content:center;
}
.video-zoom-overlay.activo{ display:flex; }
#zoom-video{ max-width:96vw; max-height:92vh; border-radius:12px; background:#000; outline:0; }


/* Bot√≥n de reporte PDF */
.btn-reporte{
  display:inline-block; padding:.45rem .8rem; border-radius:10px;
  background:#0ea5e9; color:#fff; text-decoration:none; font-weight:600;
  box-shadow:0 2px 8px rgba(0,0,0,.12); margin-left:.5rem;
}
.btn-reporte:hover{ filter:brightness(.95); }

/* === Ajuste puntual: reducir 25% el video Handicap anclado arriba-derecha === */
#video-habitacion, .video-habitacion{
  transform: scale(0.65);
  transform-origin: top right;
}
/* (Opcional) Si se necesita diferente escala por viewport, ajustar aqu√≠ con media queries */


/* === Ajustes de texto y flujo bajo el video === */
.contenido-inferior p,
.contenido-inferior h3 { 
  text-align: left;
}

/* Reservar espacio a la derecha para que el texto no quede debajo del video */
.contenido-inferior {
  padding-right: 364px; /* ‚âà 520px * 0.65 + holgura */
}

/* Opcional: en pantallas estrechas, reducir el padding para no comer demasiado ancho */
@media (max-width: 600px){
  .contenido-inferior { padding-right: 40vw; }
}


/* === Fix desbordamiento de tercera imagen en la galer√≠a === */
.galeria-habitacion {
  justify-content: flex-start; /* alinear a la izquierda */
}

/* Garantizar que las im√°genes nunca excedan su bloque */
.bloque-imagen {
  flex: 0 0 auto;
}
.bloque-imagen img {
  max-width: 100%;
  height: auto;
  display: block;
}

/* Si el ancho fijo de 280px genera corte, permite reducir levemente en pantallas medias */
@media (max-width: 1024px){
  .bloque-imagen img { width: 260px; }
}
@media (max-width: 800px){
  .bloque-imagen img { width: 220px; }
}


/* === Ajuste: reservar espacio solo para los primeros textos; galer√≠a a ancho completo === */
/* Quita el padding-right global previo en el contenedor */
.contenido-inferior { padding-right: 0 !important; }

/* Aplica el espacio a la derecha SOLO al t√≠tulo y a los primeros 8 <p> (hasta "Caracter√≠sticas") */
.contenido-inferior > h3,
.contenido-inferior > p:nth-of-type(-n+8){
  padding-right: 364px; /* ‚âà ancho del video escalado */
}
@media (max-width: 600px){
  .contenido-inferior > h3,
  .contenido-inferior > p:nth-of-type(-n+8){
    padding-right: 40vw;
  }
}

/* Galer√≠a responsive: que ninguna imagen se desborde */
.galeria-habitacion { justify-content: flex-start; }
.bloque-imagen { width: min(100%, 360px); }
.bloque-imagen img { width: 100%; height: auto; display: block; }


/* === Galer√≠a: 3 im√°genes corridas y alineadas en una fila === */
.galeria-habitacion{
  display: grid !important;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px;
  align-items: start;
  justify-items: center;
  width: 100%;
}

.bloque-imagen{ 
  width: 100% !important; 
  max-width: none !important;
}

.bloque-imagen img{
  width: 100%;
  height: auto;
  display: block;
}

/* Si el viewport se vuelve muy estrecho, mantenemos 3 columnas con scroll horizontal
   (solo si fuera necesario). Descomenta si quieres forzar 3 en m√≥vil tambi√©n.
@media (max-width: 720px){
  .galeria-habitacion{ 
    display: grid !important;
    grid-auto-flow: column;
    grid-auto-columns: 80vw;
    overflow-x: auto;
    grid-template-columns: none;
  }
}
*/


@media (max-width: 720px){
  .galeria-habitacion{ 
    display: grid !important;
    grid-auto-flow: column;
    grid-auto-columns: 80vw;
    overflow-x: auto;
    grid-template-columns: none;
    scroll-snap-type: x mandatory;
    -webkit-overflow-scrolling: touch;
  }
  .bloque-imagen{ scroll-snap-align: center; }
}



/* === HK Inventario: marca visual cuando una habitaci√≥n ya tiene registro de sillas === */
.habitacion-btn.inventario-ok{
  outline: 3px solid #c79b3b; /* dorado */
  box-shadow: 0 0 0 3px rgba(199,155,59,0.25);
}

/* Bot√≥n flotante "Comenzar" dentro del panel inferior */
.hk-comenzar {
  position: fixed;
  right: 24px;
  bottom: 24px;
  z-index: 10050;
  display: none;
  align-items: center;
  gap: .5rem;
  padding: .7rem 1rem;
  border-radius: 999px;
  background: linear-gradient(135deg,#c9a14a,#8a5a2b);
  color: #fff;
  font-weight: 700;
  border: 0;
  box-shadow: 0 10px 24px rgba(138,90,43,.35);
  cursor: pointer;
}

/* Modal de Sillas */
.hk-modal-overlay{
  display:none; position:fixed; inset:0; z-index:10060;
  background:rgba(0,0,0,.55); align-items:center; justify-content:center;
  backdrop-filter: blur(2px);
}
.hk-modal-overlay.activo{ display:flex; }
.hk-modal{
  width:min(92vw, 520px);
  background:#fff; border-radius:16px; padding:18px; 
  box-shadow: 0 24px 60px rgba(0,0,0,.35);
}
.hk-modal h3{ margin:0 0 8px; font-size:1.2rem; font-weight:800; }
.hk-form-row{ display:flex; gap:10px; align-items:center; margin:10px 0; }
.hk-form-row label{ min-width:160px; font-weight:600; }
.hk-form-row input[type="number"]{ width:120px; padding:.4rem .6rem; border:1px solid #ddd; border-radius:10px; }
.hk-form-row textarea{ width:100%; min-height:80px; padding:.6rem; border:1px solid #ddd; border-radius:10px; resize:vertical; }
.hk-actions{ display:flex; justify-content:flex-end; gap:10px; margin-top:12px; }
.hk-btn{ padding:.55rem .9rem; border-radius:10px; border:1px solid rgba(0,0,0,.1); cursor:pointer; font-weight:700; }
.hk-btn.primary{ background: linear-gradient(135deg,#c9a14a,#8a5a2b); color:#fff; border:none; }
.hk-badge-usuario{ font-size:.92rem; opacity:.85; margin-top:6px; }


.hk-stepper{ display:inline-flex; align-items:center; gap:8px; }
.hk-stepper button{ width:34px; height:34px; border-radius:8px; border:1px solid #ddd; background:#fafafa; font-weight:900; cursor:pointer; }
.hk-stepper input{ width:90px; text-align:center; }


/* === Historial de sillas (por habitaci√≥n) === */
.hk-ultima-act { font-size:.9rem; opacity:.8; margin:6px 0 8px; }
.hk-hist-toggle { margin:6px 0 10px; display:inline-flex; gap:6px; align-items:center; cursor:pointer; font-weight:700; }
.hk-hist { display:none; border:1px dashed #ddd; border-radius:12px; padding:10px; background:#fafafa; max-height:220px; overflow:auto; }
.hk-hist-item { font-size:.9rem; border-bottom:1px solid #eee; padding:6px 0; display:flex; justify-content:space-between; gap:10px; }
.hk-hist-item:last-child { border-bottom:none; }
.hk-hist-meta { opacity:.75; }
.hk-hist-actions button { border:1px solid #ddd; border-radius:8px; background:#fff; padding:.25rem .5rem; cursor:pointer; font-weight:700; }


/* Fuerza estilo premium del bot√≥n Inventario sobre .btn */
.btn.hk.boton-inventario, .boton-inventario.btn.hk {
  background: linear-gradient(135deg,#c9a14a,#8a5a2b) !important;
  color:#fff !important;
  border-color: rgba(255,255,255,.22) !important;
}


/* === Logout control (discreto, arriba-derecha) === */
.hk-logout {
  position: fixed; top: 12px; right: 14px; z-index: 10080;
  padding: .45rem .7rem; border-radius: 999px;
  background: rgba(255,255,255,.6);
  border: 1px solid rgba(0,0,0,.08);
  backdrop-filter: blur(6px) saturate(160%);
  font-weight: 700; font-size: .9rem; cursor: pointer;
  display: none;
}
.hk-logout:hover { background: rgba(255,255,255,.9); }

/* Confirmaci√≥n de cierre de sesi√≥n */
.hk-logout-overlay{
  display:none; position:fixed; inset:0; z-index:10100;
  background:rgba(0,0,0,.55); align-items:center; justify-content:center;
  backdrop-filter: blur(2px);
}
.hk-logout-overlay.activo{ display:flex; }
.hk-logout-modal{
  width:min(92vw, 420px);
  background:#fff; border-radius:16px; padding:18px;
  box-shadow: 0 24px 60px rgba(0,0,0,.35);
}
.hk-logout-modal h3{ margin:0 0 8px; font-size:1.15rem; font-weight:800; }
.hk-logout-modal p{ margin:.2rem 0 .8rem; opacity:.85; }
.hk-logout-actions{ display:flex; justify-content:flex-end; gap:10px; }
.hk-logout-btn{ padding:.55rem .9rem; border-radius:10px; border:1px solid rgba(0,0,0,.1); cursor:pointer; font-weight:700; }
.hk-logout-btn.primary{ background: linear-gradient(135deg,#c9a14a,#8a5a2b); color:#fff; border:none; }


/* === Ajustes de texto responsivo (modales y mensajes) === */
.hk-modal h3,
.hk-logout-modal h3{
  font-size: clamp(1.05rem, 2.2vw, 1.25rem);
  line-height: 1.25;
}
.hk-badge-usuario,
.hk-ultima-act,
#hk-room-label{
  font-size: clamp(.92rem, 1.8vw, 1.05rem);
  line-height: 1.35;
  word-break: break-word;
  hyphens: auto;
}
.hk-modal p,
.hk-logout-modal p,
.hk-logout-modal .hk-logout-actions .hk-logout-btn{
  font-size: clamp(.92rem, 1.65vw, 1rem);
  line-height: 1.4;
}

.mensaje-flotante{
  position: fixed;
  left: 50%;
  transform: translateX(-50%);
  bottom: 18px;
  background: rgba(0,0,0,.78);
  color: #fff;
  padding: .5rem .8rem;
  border-radius: 10px;
  font-weight: 700;
  font-size: clamp(.9rem, 1.8vw, 1rem);
  max-width: 92vw;
  text-align: center;
  z-index: 10090;
}

/* Asegurar que cualquier texto dentro del modal no se recorte */
.hk-modal, .hk-logout-modal{
  word-break: break-word;
  hyphens: auto;
}

</style>

<style>
.modal-contenido video {
    position: absolute;
    top: 10px;
    right: 10px;
    transform: scale(0.85); /* escala ajustable */
    transform-origin: top right;
    transition: transform 0.3s ease;
    cursor: zoom-in;
    max-width: 90%;
    max-height: 90%;
    border-radius: 8px;
}
.modal-contenido video.zoomed {
    transform: scale(1.6); /* zoom al hacer clic */
    cursor: zoom-out;
}
</style>


<!-- HK-INVENTARIO-START -->
<style>
/* ===== HK Inventario (aislado y seguro para index) ===== */
.hk-inv-btn {
  position: absolute; top: .5rem; right: .5rem; z-index: 10010;
  display: inline-flex; align-items: center; gap: .35rem;
  padding: .35rem .65rem; border-radius: 999px;
  background: #17a2ff; color: #fff; font-weight: 700; font-size: .9rem;
  border: none; cursor: pointer; box-shadow: 0 6px 18px rgba(0,0,0,.25);
}
.hk-inv-side {
  position: absolute; top: 0; right: 0; height: 100%; width: min(92vw, 360px);
  background: #fff; border-left: 1px solid rgba(0,0,0,.12);
  box-shadow: -10px 0 30px rgba(0,0,0,.18);
  transform: translateX(100%); transition: transform .28s ease;
  padding: .9rem; overflow: auto; z-index: 10009;
}
.hk-inv-side.hk-open { transform: translateX(0%); }
.hk-inv-side h3 { margin: .2rem 0 .6rem; font-size: 1.05rem; }
.hk-inv-muted { color: #666; font-size: .92rem; }
/* Asegurar que las tarjetas del modal puedan albergar overlay sin romper layout */
.bloque-imagen { position: relative; }
</style>

</head>
<body>

  <h1 class="titulo-catalogo">
  <span>Paradisus ¬∑ Colecci√≥n Exclusiva de Habitaciones & Suites</span>
  <img loading="lazy" src="https://res.cloudinary.com/dor6za85u/image/upload/v1754887647/ChatGPT_Image_10_ago_2025_09_47_11_p.m._btrjfp.png" 
       alt="Paradisus by Meli√°" 
       class="logo-catalogo">
</h1>



  <div class="habitacion-info-panel" id="panelHabitacion">
  <div class="habitacion-detalle" id="contenidoHabitacion">
    <!-- Aqu√≠ se insertar√° el contenido din√°mico -->
  </div>

<!-- Panel de filtro por categor√≠a -->
<div class="panel-filtro-categoria">
  <label for="filtro-categoria">Categor√≠a:</label>
  <select id="filtro-categoria">
    <option value="">Todas</option>
  </select>

  
  <label for="filtro-cama">Cama:</label>
  <select id="filtro-cama">
    <option value="">Todas</option>
    <option value="K">K</option>
    <option value="D">D</option>
  </select>

  <label for="filtro-prefijo">Recepci√≥n:</label>
  <select id="filtro-prefijo" title="Recepci√≥n">
    <option value="">Todas</option>
    <option value="C">PLC - Paradisus</option>
    <option value="S">THR - The Reserve</option>
  </select>

  <label class="chk"><input type="checkbox" id="filtro-handicap"> Handicap ‚ôø</label>
  <label class="chk"><input type="checkbox" id="filtro-cocineta"> Cocineta</label>

  <span id="totales-resumen" class="contador-categoria">
    K: 0 ¬∑ D: 0 ¬∑ Total: 0 ‚Äî Reserve: 0 ¬∑ ‚ôø: 0 ¬∑ Cocineta: 0
  </span>
  <a id="btn-descargar-pdf" href="introduccion_paradisus_2025.pdf" download class="btn-reporte" title="Descargar reporte PDF" target="_blank">üìÑ Descargar PDF</a>

<button id="btn-limpiar-filtro" type="button">Limpiar</button>

  <span class="contador-categoria">
    Coincidencias: <strong id="total-coincidencias-categoria">0</strong>
  </span>
</div>
<div id="totales-tabla" class="totales-tabla" style="padding: 10px 16px;"></div>


  <div class="zona-desplazable">

    <!-- Torre 1 -->
    <div class="torre">
      <h2>Torre 1</h2>
      <div class="piso">
<button class="habitacion-btn" data-num="1501">1501</button>
<button class="habitacion-btn" data-num="1502">1502</button>
<button class="habitacion-btn" data-num="1503">1503</button>
<button class="habitacion-btn" data-num="1504">1504</button>
<button class="habitacion-btn" data-num="1505">1505</button>
<button class="habitacion-btn" data-num="1506">1506</button>
<button class="habitacion-btn" data-num="1507">1507</button>
<button class="habitacion-btn" data-num="1508">1508</button>
<button class="habitacion-btn" data-num="1509">1509</button>
<button class="habitacion-btn" data-num="1510">1510</button>

      </div>

      <div class="pasillo"></div>

      <div class="piso">
<button class="habitacion-btn" data-num="1522">1522</button>
<button class="habitacion-btn" data-num="1521">1521</button>
<button class="habitacion-btn" data-num="1520">1520</button>
<button class="habitacion-btn" data-num="1519">1519</button>
<button class="habitacion-btn" data-num="1518">1518</button>
<button class="habitacion-btn" data-num="1517">1517</button>
<button class="habitacion-btn" data-num="1516">1516</button>
<button class="habitacion-btn" data-num="1515">1515</button>
<button class="habitacion-btn" data-num="1514">1514</button>
<button class="habitacion-btn" data-num="1512">1512</button>
<button class="habitacion-btn" data-num="1511">1511</button>

      </div>

      <div class="pasillo"></div>

      <div class="piso">
<button class="habitacion-btn" data-num="1401">1401</button>
<button class="habitacion-btn" data-num="1402">1402</button>
<button class="habitacion-btn" data-num="1403">1403</button>
<button class="habitacion-btn" data-num="1404">1404</button>
<button class="habitacion-btn" data-num="1405">1405</button>
<button class="habitacion-btn" data-num="1406">1406</button>
<button class="habitacion-btn" data-num="1407">1407</button>
<button class="habitacion-btn" data-num="1408">1408</button>
<button class="habitacion-btn" data-num="1409">1409</button>
<button class="habitacion-btn" data-num="1410">1410</button>

      </div>

      <div class="pasillo"></div>

      <div class="piso">
<button class="habitacion-btn" data-num="1422">1422</button>
        <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="1421">1421</button>
<button class="habitacion-btn" data-num="1420">1420</button>
<button class="habitacion-btn" data-num="1419">1419</button>
<button class="habitacion-btn" data-num="1418">1418</button>
<button class="habitacion-btn" data-num="1417">1417</button>
<button class="habitacion-btn" data-num="1416">1416</button>
<button class="habitacion-btn" data-num="1415">1415</button>
<button class="habitacion-btn" data-num="1414">1414</button>
<button class="habitacion-btn" data-num="1412">1412</button>
<button class="habitacion-btn" data-num="1411">1411</button>

      </div>

      <div class="pasillo"></div>

      <div class="piso">
<button class="habitacion-btn" data-num="1301">1301</button>
<button class="habitacion-btn" data-num="1302">1302</button>
<button class="habitacion-btn" data-num="1303">1303</button>
<button class="habitacion-btn" data-num="1304">1304</button>
<button class="habitacion-btn" data-num="1305">1305</button>
<button class="habitacion-btn" data-num="1306">1306</button>
<button class="habitacion-btn" data-num="1307">1307</button>
<button class="habitacion-btn" data-num="1308">1308</button>
<button class="habitacion-btn" data-num="1309">1309</button>
<button class="habitacion-btn" data-num="1310">1310</button>

      </div>

      <div class="pasillo"></div>

      <div class="piso">
<button class="habitacion-btn" data-num="1322">1322</button>
<button class="habitacion-btn" data-num="1321">1321</button>
<button class="habitacion-btn" data-num="1320">1320</button>
<button class="habitacion-btn" data-num="1319">1319</button>
<button class="habitacion-btn" data-num="1318">1318</button>
<button class="habitacion-btn" data-num="1317">1317</button>
<button class="habitacion-btn" data-num="1316">1316</button>
<button class="habitacion-btn" data-num="1315">1315</button>
<button class="habitacion-btn" data-num="1314">1314</button>
<button class="habitacion-btn" data-num="1312">1312</button>
<button class="habitacion-btn" data-num="1311">1311</button>

      </div>

      <div class="pasillo"></div>

      <!-- Piso 12 (solo externas) -->
<div class="fila-base jardin-ficticio">
    üåµ JARD√çN DE CACTUS ‚Äî ESPEJO DE AGUA üåä
</div>

      <div class="pasillo"></div>

      <div class="piso">
<button class="habitacion-btn" data-num="1222">1222</button>
        <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="1221">1221</button>
<button class="habitacion-btn" data-num="1220">1220</button>
        <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="1219">1219</button>
<button class="habitacion-btn" data-num="1218">1218</button>
        <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="1217">1217</button>
<button class="habitacion-btn" data-num="1216">1216</button>
        <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="1215">1215</button>
<button class="habitacion-btn" data-num="1214">1214</button>
        <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="1212">1212</button>
<button class="habitacion-btn" data-num="1211">1211</button>

      </div>
    </div>

<!-- Torre 2 -->
<div class="torre torre-2">
  <h2>Torre 2</h2>
  <!-- Piso 4 - Vista Interna -->
  <div class="piso">
<button class="habitacion-btn" data-num="2401">2401</button>
<button class="habitacion-btn" data-num="2402">2402</button>
<button class="habitacion-btn" data-num="2403">2403</button>
<button class="habitacion-btn" data-num="2404">2404</button>
<button class="habitacion-btn" data-num="2405">2405</button>
<button class="habitacion-btn" data-num="2406">2406</button>
<button class="habitacion-btn" data-num="2407">2407</button>
<button class="habitacion-btn" data-num="2408">2408</button>

    </div>

    <div class="pasillo"></div>

    <!-- Piso 4 - Vista Externa -->
     <div class="piso">
<button class="habitacion-btn" data-num="2418">2418</button>
<button class="habitacion-btn" data-num="2417">2417</button>
<button class="habitacion-btn" data-num="2416">2416</button>
<button class="habitacion-btn" data-num="2415">2415</button>
<button class="habitacion-btn" data-num="2414">2414</button>
<button class="habitacion-btn" data-num="2412">2412</button>
<button class="habitacion-btn" data-num="2411">2411</button>
<button class="habitacion-btn" data-num="2410">2410</button>
<button class="habitacion-btn" data-num="2409">2409</button>

  </div>

  <div class="pasillo"></div>

  <!-- Piso 2 - Vista Interna -->
  <div class="piso">
<button class="habitacion-btn" data-num="2301">2301</button>
<button class="habitacion-btn" data-num="2302">2302</button>
<button class="habitacion-btn" data-num="2303">2303</button>
<button class="habitacion-btn" data-num="2304">2304</button>
<button class="habitacion-btn" data-num="2305">2305</button>
<button class="habitacion-btn" data-num="2306">2306</button>
<button class="habitacion-btn" data-num="2307">2307</button>
<button class="habitacion-btn" data-num="2308">2308</button>

    </div>

  <div class="pasillo"></div>

  <!-- Piso 3 - Vista Externa -->
  <div class="piso">
<button class="habitacion-btn" data-num="2318">2318</button>
<button class="habitacion-btn" data-num="2317">2317</button>
<button class="habitacion-btn" data-num="2316">2316</button>
<button class="habitacion-btn" data-num="2315">2315</button>
<button class="habitacion-btn" data-num="2314">2314</button>
<button class="habitacion-btn" data-num="2312">2312</button>
<button class="habitacion-btn" data-num="2311">2311</button>
<button class="habitacion-btn" data-num="2310">2310</button>
<button class="habitacion-btn" data-num="2309">2309</button>

  </div>

  <div class="pasillo"></div>

  <!-- Piso 2 - Vista Interna -->
  <div class="piso">
<button class="habitacion-btn" data-num="2201">2201</button>
<button class="habitacion-btn" data-num="2202">2202</button>
<button class="habitacion-btn" data-num="2203">2203</button>
<button class="habitacion-btn" data-num="2204">2204</button>
<button class="habitacion-btn" data-num="2205">2205</button>
<button class="habitacion-btn" data-num="2206">2206</button>
<button class="habitacion-btn" data-num="2207">2207</button>
<button class="habitacion-btn" data-num="2208">2208</button>

    </div>

    <div class="pasillo"></div>

    <!-- Piso 2 - Vista Externa -->
     <div class="piso">
<button class="habitacion-btn" data-num="2218">2218</button>
<button class="habitacion-btn" data-num="2217">2217</button>
<button class="habitacion-btn" data-num="2216">2216</button>
<button class="habitacion-btn" data-num="2215">2215</button>
<button class="habitacion-btn" data-num="2214">2214</button>
<button class="habitacion-btn" data-num="2212">2212</button>
<button class="habitacion-btn" data-num="2211">2211</button>
<button class="habitacion-btn" data-num="2210">2210</button>
<button class="habitacion-btn" data-num="2209">2209</button>

  </div>

    <div class="pasillo"></div>

  <div class="fila-base jardin-ficticio">
    üåµ JARD√çN DE CACTUS ‚Äî ESPEJO DE AGUA üåä
</div>

  <div class="pasillo"></div>

  <!-- Piso 1 - Vista Externa -->
  <div class="piso">
<button class="habitacion-btn" data-num="2118">2118</button>
<button class="habitacion-btn" data-num="2117">2117</button>
<button class="habitacion-btn" data-num="2116">2116</button>
<button class="habitacion-btn" data-num="2115">2115</button>
<button class="habitacion-btn" data-num="2114">2114</button>
<button class="habitacion-btn" data-num="2112">2112</button>
<button class="habitacion-btn" data-num="2111">2111</button>
<button class="habitacion-btn" data-num="2110">2110</button>
<button class="habitacion-btn" data-num="2109">2109</button>

  </div>
</div>

    <!-- Torre 3 -->
    <div class="torre torre-3">
      <h2>Torre 3</h2>
      <div class="piso">
<button class="habitacion-btn" data-num="3301">3301</button>
<button class="habitacion-btn" data-num="3302">3302</button>
<button class="habitacion-btn" data-num="3303">3303</button>
<button class="habitacion-btn" data-num="3304">3304</button>
<button class="habitacion-btn" data-num="3305">3305</button>
<button class="habitacion-btn" data-num="3306">3306</button>
<button class="habitacion-btn" data-num="3307">3307</button>
<button class="habitacion-btn" data-num="3308">3308</button>
<button class="habitacion-btn" data-num="3309">3309</button>
<button class="habitacion-btn" data-num="3310">3310</button>
<button class="habitacion-btn" data-num="3311">3311</button>
<button class="habitacion-btn" data-num="3312">3312</button>

      </div>

       <div class="pasillo"></div>

<div class="fila-base">
<button class="habitacion-btn" data-num="3330">3330</button>
<button class="habitacion-btn" data-num="3329">3329</button>
<button class="habitacion-btn" data-num="3328">3328</button>
<button class="habitacion-btn" data-num="3327">3327</button>
<button class="habitacion-btn" data-num="3326">3326</button>
<button class="habitacion-btn" data-num="3325">3325</button>
<button class="habitacion-btn" data-num="3324">3324</button>
<button class="habitacion-btn" data-num="3323">3323</button>
<button class="habitacion-btn" data-num="3322">3322</button>
<button class="habitacion-btn" data-num="3321">3321</button>
<button class="habitacion-btn" data-num="3320">3320</button>

</div>

          <div class="pasillo"></div>

<div class="fila-base">
<button class="habitacion-btn" data-num="3201">3201</button>
<button class="habitacion-btn" data-num="3202">3202</button>
<button class="habitacion-btn" data-num="3203">3203</button>
<button class="habitacion-btn" data-num="3204">3204</button>
<button class="habitacion-btn" data-num="3205">3205</button>
<button class="habitacion-btn" data-num="3206">3206</button>
<button class="habitacion-btn" data-num="3207">3207</button>
<button class="habitacion-btn" data-num="3208">3208</button>
<button class="habitacion-btn" data-num="3209">3209</button>
<button class="habitacion-btn" data-num="3210">3210</button>
<button class="habitacion-btn" data-num="3211">3211</button>
<button class="habitacion-btn" data-num="3212">3212</button>

  </div>

<div class="fila-base">
<button class="habitacion-btn" data-num="3214">3214</button>
  <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="3215">3215</button>
<button class="habitacion-btn" data-num="3216">3216</button>
<button class="habitacion-btn" data-num="3217">3217</button>
<button class="habitacion-btn" data-num="3218">3218</button>
  <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->

    </div>

<div class="fila-base">
<button class="habitacion-btn" data-num="3230">3230</button>
<button class="habitacion-btn" data-num="3229">3229</button>
<button class="habitacion-btn" data-num="3228">3228</button>
<button class="habitacion-btn" data-num="3227">3227</button>
<button class="habitacion-btn" data-num="3226">3226</button>
<button class="habitacion-btn" data-num="3225">3225</button>
<button class="habitacion-btn" data-num="3224">3224</button>
<button class="habitacion-btn" data-num="3223">3223</button>
<button class="habitacion-btn" data-num="3222">3222</button>
<button class="habitacion-btn" data-num="3221">3221</button>
<button class="habitacion-btn" data-num="3220">3220</button>
<button class="habitacion-btn" data-num="3219">3219</button>
  <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->

    </div>

   <div class="pasillo"></div>

      <div class="fila-base">
<button class="habitacion-btn" data-num="3101">3101</button>
<button class="habitacion-btn" data-num="3102">3102</button>
<button class="habitacion-btn" data-num="3103">3103</button>
<button class="habitacion-btn" data-num="3104">3104</button>
<button class="habitacion-btn" data-num="3105">3105</button>
<button class="habitacion-btn" data-num="3106">3106</button>
<button class="habitacion-btn" data-num="3107">3107</button>
<button class="habitacion-btn" data-num="3108">3108</button>
<button class="habitacion-btn" data-num="3109">3109</button>
<button class="habitacion-btn" data-num="3110">3110</button>
<button class="habitacion-btn" data-num="3111">3111</button>
<button class="habitacion-btn" data-num="3112">3112</button>

</div>

      <div class="columna-derecha">
<button class="habitacion-btn" data-num="3114">3114</button>
        <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="3115">3115</button>
<button class="habitacion-btn" data-num="3116">3116</button>
<button class="habitacion-btn" data-num="3117">3117</button>
<button class="habitacion-btn" data-num="3118">3118</button>
        <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->

</div>

      <div class="fila-base">
<button class="habitacion-btn" data-num="3130">3130</button>
<button class="habitacion-btn" data-num="3129">3129</button>
<button class="habitacion-btn" data-num="3128">3128</button>
<button class="habitacion-btn" data-num="3127">3127</button>
<button class="habitacion-btn" data-num="3126">3126</button>
<button class="habitacion-btn" data-num="3125">3125</button>
<button class="habitacion-btn" data-num="3124">3124</button>
<button class="habitacion-btn" data-num="3123">3123</button>
<button class="habitacion-btn" data-num="3122">3122</button>
<button class="habitacion-btn" data-num="3121">3121</button>
<button class="habitacion-btn" data-num="3120">3120</button>
<button class="habitacion-btn" data-num="3119">3119</button>
        <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->

</div>



       <div class="pasillo"></div>

<div class="columna-derecha">
<button class="habitacion-btn" data-num="3014">3014</button>
  <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="3015">3015</button>
<button class="habitacion-btn" data-num="3016">3016</button>
<button class="habitacion-btn" data-num="3017">3017</button>
<button class="habitacion-btn" data-num="3018">3018</button>
  <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->

</div>
<div class="pasillo"></div>
            <div class="fila-base jardin-ficticio">
    üåµ JARD√çN DE CACTUS üåµ
              </div>
<div class="pasillo"></div>        
      <div class="fila-base">
<button class="habitacion-btn" data-num="3030">3030</button>
<button class="habitacion-btn" data-num="3029">3029</button>
<button class="habitacion-btn" data-num="3028">3028</button>
<button class="habitacion-btn" data-num="3027">3027</button>
<button class="habitacion-btn" data-num="3026">3026</button>
<button class="habitacion-btn" data-num="3025">3025</button>
<button class="habitacion-btn" data-num="3024">3024</button>
<button class="habitacion-btn" data-num="3023">3023</button>
<button class="habitacion-btn" data-num="3022">3022</button>
<button class="habitacion-btn" data-num="3021">3021</button>
<button class="habitacion-btn" data-num="3020">3020</button>
<button class="habitacion-btn" data-num="3019">3019</button>
        <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->

</div>

    </div>

    <!-- Torre 4 -->
<div class="torre torre-4">
      <h2>Torre 4</h2>
      <div class="piso">
<button class="habitacion-btn" data-num="4529">4529</button>
<button class="habitacion-btn" data-num="4528">4528</button>
<button class="habitacion-btn" data-num="4527">4527</button>
<button class="habitacion-btn" data-num="4526">4526</button>
<button class="habitacion-btn" data-num="4525">4525</button>
<button class="habitacion-btn" data-num="4524">4524</button>
<button class="habitacion-btn" data-num="4523">4523</button>
<button class="habitacion-btn" data-num="4522">4522</button>
<button class="habitacion-btn" data-num="4521">4521</button>
        <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4520">4520</button>
<button class="habitacion-btn" data-num="4519">4519</button>
<button class="habitacion-btn" data-num="4518">4518</button>

</div>

  <div class="fila-base">
<button class="habitacion-btn" data-num="4517">4517</button>
    <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4516">4516</button>
<button class="habitacion-btn" data-num="4515">4515</button>
<button class="habitacion-btn" data-num="4514">4514</button>
    <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4512">4512</button>
    <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4511">4511</button>

</div>

  <div class="fila-base">
<button class="habitacion-btn" data-num="4501">4501</button>
<button class="habitacion-btn" data-num="4502">4502</button>
<button class="habitacion-btn" data-num="4503">4503</button>
<button class="habitacion-btn" data-num="4504">4504</button>
<button class="habitacion-btn" data-num="4505">4505</button>
<button class="habitacion-btn" data-num="4506">4506</button>
<button class="habitacion-btn" data-num="4507">4507</button>
<button class="habitacion-btn" data-num="4508">4508</button>
<button class="habitacion-btn" data-num="4509">4509</button>
<button class="habitacion-btn" data-num="4510">4510</button>

</div>

  <div class="pasillo"></div>

  <div class="fila-base">
<button class="habitacion-btn" data-num="4429">4429</button>
    <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4428">4428</button>
<button class="habitacion-btn" data-num="4427">4427</button>
<button class="habitacion-btn" data-num="4426">4426</button>
    <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4425">4425</button>
<button class="habitacion-btn" data-num="4424">4424</button>
    <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4423">4423</button>
<button class="habitacion-btn" data-num="4422">4422</button>
    <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4421">4421</button>
<button class="habitacion-btn" data-num="4420">4420</button>
    <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4419">4419</button>
<button class="habitacion-btn" data-num="4418">4418</button>

</div>

  <div class="fila-base">
<button class="habitacion-btn" data-num="4417">4417</button>
    <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4416">4416</button>
<button class="habitacion-btn" data-num="4415">4415</button>
<button class="habitacion-btn" data-num="4414">4414</button>
<button class="habitacion-btn" data-num="4412">4412</button>
    <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4411">4411</button>

</div>

  <div class="fila-base">
<button class="habitacion-btn" data-num="4401">4401</button>
<button class="habitacion-btn" data-num="4402">4402</button>
    <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4403">4403</button>
<button class="habitacion-btn" data-num="4404">4404</button>
    <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4405">4405</button>
<button class="habitacion-btn" data-num="4406">4406</button>
    <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4407">4407</button>
<button class="habitacion-btn" data-num="4408">4408</button>
<button class="habitacion-btn" data-num="4409">4409</button>
<button class="habitacion-btn" data-num="4410">4410</button>

</div> 

<div class="pasillo"></div>

<div class="fila-base">
<button class="habitacion-btn" data-num="4329">4329</button>
<button class="habitacion-btn" data-num="4328">4328</button>
<button class="habitacion-btn" data-num="4327">4327</button>
<button class="habitacion-btn" data-num="4326">4326</button>
<button class="habitacion-btn" data-num="4325">4325</button>
   <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4324">4324</button>
<button class="habitacion-btn" data-num="4323">4323</button>
  <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4322">4322</button>
<button class="habitacion-btn" data-num="4321">4321</button>
  <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4320">4320</button>
<button class="habitacion-btn" data-num="4319">4319</button>
  <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4318">4318</button>

</div>

<div class="fila-base">
<button class="habitacion-btn" data-num="4317">4317</button>
  <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4316">4316</button>
<button class="habitacion-btn" data-num="4315">4315</button>
<button class="habitacion-btn" data-num="4314">4314</button>
<button class="habitacion-btn" data-num="4312">4312</button>
  <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4311">4311</button>
</div>


<div class="fila-base">
<button class="habitacion-btn" data-num="4301">4301</button>
<button class="habitacion-btn" data-num="4302">4302</button>
<button class="habitacion-btn" data-num="4303">4303</button>
<button class="habitacion-btn" data-num="4304">4304</button>
<button class="habitacion-btn" data-num="4305">4305</button>
<button class="habitacion-btn" data-num="4306">4306</button>
  <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4307">4307</button>
<button class="habitacion-btn" data-num="4308">4308</button>
<button class="habitacion-btn" data-num="4309">4309</button>
  <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4310">4310</button>

</div>

<div class="pasillo"></div>


<div class="fila-base">
<button class="habitacion-btn" data-num="4229">4229</button>
<button class="habitacion-btn" data-num="4228">4228</button>
<button class="habitacion-btn" data-num="4227">4227</button>
<button class="habitacion-btn" data-num="4226">4226</button>
<button class="habitacion-btn" data-num="4225">4225</button>
    <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4224">4224</button>
<button class="habitacion-btn" data-num="4223">4223</button>
<button class="habitacion-btn" data-num="4222">4222</button>
<button class="habitacion-btn" data-num="4221">4221</button>
  <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4220">4220</button>
<button class="habitacion-btn" data-num="4219">4219</button>
    <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4218">4218</button>

</div>

<div class="fila-base">
<button class="habitacion-btn" data-num="4217">4217</button>
  <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4216">4216</button>
<button class="habitacion-btn" data-num="4215">4215</button>
<button class="habitacion-btn" data-num="4214">4214</button>
<button class="habitacion-btn" data-num="4212">4212</button>
  <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4211">4211</button>

</div>

<div class="fila-base">
<button class="habitacion-btn" data-num="4201">4201</button>
<button class="habitacion-btn" data-num="4202">4202</button>
<button class="habitacion-btn" data-num="4203">4203</button>
<button class="habitacion-btn" data-num="4204">4204</button>
<button class="habitacion-btn" data-num="4205">4205</button>
<button class="habitacion-btn" data-num="4206">4206</button>
  <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4207">4207</button>
<button class="habitacion-btn" data-num="4208">4208</button>
<button class="habitacion-btn" data-num="4209">4209</button>
  <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4210">4210</button>

</div>

<div class="pasillo"></div>
              <div class="fila-base jardin-ficticio">
    üåµ EDIFICIO / PASILLO üåµ
              </div>
  <div class="pasillo"></div>

  <div class="fila-base">
<button class="habitacion-btn" data-num="4117">4117</button>
<button class="habitacion-btn" data-num="4116">4116</button>
<button class="habitacion-btn" data-num="4115">4115</button>
<button class="habitacion-btn" data-num="4114">4114</button>
<button class="habitacion-btn" data-num="4112">4112</button>
    <div class="conector-conectadas">‚áÑ</div>  <!-- Flecha de doble punta -->
<button class="habitacion-btn" data-num="4111">4111</button>
  </div>
</div>


  <!-- Panel flotante inferior -->
  <div id="panelInferior" class="panel-inferior">
    <div id="mensajeSeleccion" class="mensaje-inicial">
  ‚ÑπÔ∏è Selecciona una habitaci√≥n para ver m√°s detalles.
</div>
</div>

  <!-- Lightbox de imagen -->
<div id="zoom-overlay" class="visor-oculto" onclick="cerrarZoom(event)">
  <span id="zoom-close" onclick="cerrarZoom(event)" style="position: absolute; top: 20px; right: 30px; font-size: 30px; cursor: pointer; color: white;">‚ùå</span>
  <img loading="lazy" id="zoom-img" src="" alt="Zoom" />
</div>

  <script>

async function mostrarInfo(num) {
  const panel = document.getElementById("panelInferior");
  const mensaje = document.getElementById("mensajeSeleccion");
  if (mensaje) mensaje.style.display = "none";

  try {
    const response = await fetch("habitaciones.json");
    const data = await response.json();

    if (data[num]) {
      const habitacion = data[num];

      let galeriaHTML = '<div class="galeria-habitacion">';
      habitacion.imagenes.forEach((imagen) => {
        galeriaHTML += `
          <div class="bloque-imagen">
            <img loading="lazy" src="${imagen.src}" alt="${imagen.etiqueta}" onclick="hacerZoom(this.src)" />
            <p><strong>${imagen.etiqueta}</strong></p>
          </div>
        `;
      });
      galeriaHTML += '</div>';

panel.innerHTML = `
  <div class="contenido-inferior">\n<aside id="video-habitacion" class="video-habitacion" hidden>\n  <div class="video-ratio">\n    <iframe id="video-embed" src="" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen hidden></iframe>\n    <video id="video-mp4" controls playsinline hidden></video>\n  </div>\n</aside>\n
    <h3>${habitacion.titulo}</h3>
    <div class="modal-toolbar">
      <button class="boton-inventario btn hk" id="btn-inventario" onclick="handleInventarioClick('${num}')" >Inventario</button>
    </div>
    <p><strong>Categor√≠a:</strong> ${habitacion.categoria} ¬∑ ${habitacion.vista}</p>
    <p><strong>Habitaci√≥n conectada:</strong> ${habitacion.habitacion_conectada ? habitacion.habitacion_conectada : 'No aplica'}</p>
    <p><strong>Piso:</strong> ${habitacion.piso}</p>
    <p><strong>Capacidad:</strong> ${habitacion.capacidad} ¬∑ ${habitacion.fumadores ? '' : 'No fumadores'}</p>
    <p><strong>Tipo de cama:</strong> ${habitacion.tipo_cama}</p>
    <p><strong>Sof√° cama:</strong> ${habitacion.sofa ? 'Incluido' : 'No disponible'}</p>
    <p><strong>Accesibilidad:</strong> ${habitacion.discapacidad ? 'Adaptada' : 'No adaptada'}</p>
    <p><strong>Caracter√≠sticas:</strong> ${habitacion.caracteristicas.join(', ')}</p>
    ${galeriaHTML}
    <button class="btn-volver" onclick="cerrarPanelInferior()">Cerrar</button>
  </div>
`;
    
    // --- Video handicap (arriba-derecha) ---
    try {
  if (habitacion && (habitacion.discapacidad === true)) {
    const v = (window.VIDEOS_HAB && window.VIDEOS_HAB[num]) || window.HANDICAP_VIDEO_URL || "";
    setVideoHabitacion(v);

    // üü¢ Autoplay + mute aqu√≠
    const video = document.querySelector("#video-mp4");
    if(video){
      video.muted = true;        // üîá requerido en m√≥viles
      video.setAttribute("muted","");
      video.playsInline = true;  // evita fullscreen en iOS
      video.autoplay = true;     // autoplay
      video.loop = true;         // üîÅ se repite al terminar
      video.currentTime = 0;

      const p = video.play();
      if(p && typeof p.catch === "function") p.catch(()=>{});
    }

  } else {
    stopVideoHabitacion();
    setVideoHabitacion(""); // oculta
  }
}catch(e){}
} else {
      panel.innerHTML = `
        <div class="contenido-inferior">
          <p>üîç Informaci√≥n no disponible para la habitaci√≥n ${num}.</p>
          <button class="btn-volver" onclick="cerrarPanelInferior()">Cerrar</button>
        </div>
      `;
    }

    panel.style.display = "block";
    document.body.style.overflow = "hidden";
  } catch (error) {
    panel.innerHTML = `
      <div class="contenido-inferior">
        <p>‚ö†Ô∏è Error al cargar la informaci√≥n. Intenta de nuevo.</p>
        <button class="btn-volver" onclick="cerrarPanelInferior()">Cerrar</button>
      </div>
    `;
    panel.style.display = "block";
    document.body.style.overflow = "hidden";
  }
}

function cerrarPanelInferior() {
  const panel = document.getElementById("panelInferior");
  const mensaje = document.getElementById("mensajeSeleccion");

  panel.style.display = "none";
  document.body.style.overflow = "auto";

  if (mensaje) mensaje.style.display = "block";
}

async function marcarHabitacionesDisponibles() {
  try {
    const response = await fetch("habitaciones.json");
    const data = await response.json();
    const botones = document.querySelectorAll(".habitacion-btn");

    botones.forEach(boton => {
const num = boton.dataset.num || boton.textContent.trim();
      const habitacion = data[num];

      if (habitacion) {
        boton.classList.add("disponible");

        // Determinar tipo de cama
        const tipoCama = habitacion.tipo_cama === "K" ? "K" : "D";

        if (habitacion.tipo_cama === "K") {
  boton.classList.add("tipo-k");
} else if (habitacion.tipo_cama === "D") {
  boton.classList.add("tipo-d");


}


        // Verificar si tiene sof√° cama
const sofaIcon = `
  ${habitacion.sofa ? '<img loading="lazy" src="https://res.cloudinary.com/dor6za85u/image/upload/v1753173371/sof%C3%A0_pzyjdc.png" style="height: 18px; vertical-align: middle;" />' : ''}
  ${habitacion.discapacidad ? '<span style="font-size: 1.2em;">‚ôø</span>' : ''}
`;

        // Crear nuevo contenido
        boton.innerHTML = `
          <div style="display: flex; flex-direction: column; align-items: center;">
            <div>${num}</div>
            <div style="font-size: 0.9em;">${tipoCama}${sofaIcon}</div>
          </div>
        `;
      }
    });
  } catch (error) {
    console.error("Error al cargar habitaciones disponibles:", error);
  }
}

// Ejecutar al cargar
window.addEventListener("DOMContentLoaded", marcarHabitacionesDisponibles);

    let datosActuales = {}; // Aqu√≠ guardaremos los datos iniciales para comparar m√°s adelante

document.addEventListener("DOMContentLoaded", () => {
  const botones = document.querySelectorAll(".habitacion-btn");
  botones.forEach(boton => {
    boton.addEventListener("click", () => {
      const num = boton.dataset.num;
      mostrarInfo(num);
    });
  });
});

// Drag-scroll solo una vez
const zona = document.querySelector('.zona-desplazable');
let isDown = false, startX, scrollLeft;

zona.addEventListener('mousedown', (e) => {
  isDown = true;
  zona.classList.add('arrastrando');
  startX = e.pageX - zona.offsetLeft;
  scrollLeft = zona.scrollLeft;
});
zona.addEventListener('mouseleave', () => { isDown = false; zona.classList.remove('arrastrando'); });
zona.addEventListener('mouseup', () => { isDown = false; zona.classList.remove('arrastrando'); });
zona.addEventListener('mousemove', (e) => {
  if (!isDown) return;
  e.preventDefault();
  const x = e.pageX - zona.offsetLeft;
  zona.scrollLeft = scrollLeft - (x - startX);
});

    async function actualizarHabitacionesSilenciosamente() {
  try {
    const response = await fetch("habitaciones.json");
    const nuevosDatos = await response.json();
    const botones = document.querySelectorAll(".habitacion-btn");

    botones.forEach(boton => {
      const num = boton.dataset.num || boton.textContent.trim();
      const nuevaData = nuevosDatos[num];
      const actualData = datosActuales[num];

      if (nuevaData && JSON.stringify(nuevaData) !== JSON.stringify(actualData)) {
        const tipoCama = nuevaData.tipo_cama === "K" ? "K" : "D";

if (nuevaData.tipo_cama === "K") {
  boton.classList.add("tipo-k");
} else if (nuevaData.tipo_cama === "D") {
  boton.classList.add("tipo-d");
}

        const sofaIcon = `
          ${nuevaData.sofa ? '<img loading="lazy" src="https://res.cloudinary.com/dor6za85u/image/upload/v1753173371/sof%C3%A0_pzyjdc.png" style="height: 18px; vertical-align: middle;" />' : ''}
          ${nuevaData.discapacidad ? '<span style="font-size: 1.2em;">‚ôø</span>' : ''}
        `;

        boton.innerHTML = `
          <div style="display: flex; flex-direction: column; align-items: center;">
            <div>${num}</div>
            <div style="font-size: 0.9em;">${tipoCama}${sofaIcon}</div>
          </div>
        `;

        boton.classList.add("disponible");
      }
    });

    datosActuales = nuevosDatos;

  } catch (error) {
    console.warn("No se pudo actualizar habitaciones en segundo plano:", error);
  }
}
setInterval(actualizarHabitacionesSilenciosamente, 5000); // Se actualiza cada 5 segundos

document.addEventListener('DOMContentLoaded', async () => {
  const sel = document.getElementById('filtro-categoria');
  const btnClear = document.getElementById('btn-limpiar-filtro');
  const totalEl = document.getElementById('total-coincidencias-categoria');

  let habitacionesData = null;

  // Cargar JSON de habitaciones
  async function cargarHabitaciones() {
    if (!habitacionesData) {
      const resp = await fetch('habitaciones.json');
      habitacionesData = await resp.json();
    }
    return habitacionesData;
  }

  // Llenar select con categor√≠as
  async function initCategorias() {
    const data = await cargarHabitaciones();
    const categorias = new Set(Object.values(data).map(h => h.categoria).filter(Boolean));
    [...categorias].sort().forEach(cat => {
      const opt = document.createElement('option');
      opt.value = cat;
      opt.textContent = cat;
      sel.appendChild(opt);
    });
  }

  // Aplicar filtro visual
  async function aplicarFiltro(categoria) {
  const data = await cargarHabitaciones();
  let count = 0;

  // Quitamos espacios y normalizamos
  const catSel = (categoria || '').trim();

  document.querySelectorAll('.habitacion-btn').forEach(btn => {
    const num = btn.dataset.num || btn.textContent.trim();
    const habitacion = data[num];
    const catHab = ((habitacion && habitacion.categoria) || '').trim();

    if (catSel) {
      // Si hay una categor√≠a seleccionada, comparar
      const coincide = catHab.toLowerCase() === catSel.toLowerCase();
      btn.classList.toggle('filtro-activo', coincide);
      btn.classList.toggle('filtro-inactivo', !coincide);
      if (coincide) count++;
    } else {
      // Si est√° en "Todas", limpiar clases
      btn.classList.remove('filtro-activo', 'filtro-inactivo');
      count++;
    }
  });

  totalEl.textContent = count;
}

  // Eventos
  sel.addEventListener('change', e => aplicarFiltro(e.target.value));
  btnClear.addEventListener('click', () => {
    sel.value = '';
    aplicarFiltro('');
  });

  // Inicializar
  await initCategorias();
  aplicarFiltro('');
});
    </script>  <!-- ‚úÖ Cierra aqu√≠ tu script principal -->

<div id="modal-mejoras" class="modal-mejoras" role="dialog" aria-modal="true" aria-labelledby="titulo-novedades">
  <div class="modal-contenido">
    <h2>üÜïBIENVENID@ - Novedades del Cat√°logo</h2>
    <ul>
      <li>‚ú® Panel de filtrado de categor√≠as mejorado.</li>
      <li>üíì Animaci√≥n de latido para habitaciones filtradas.</li>
      <li>üåó Oscurecido de habitaciones no coincidentes.</li>
      <li>üè∑Ô∏è Nuevo t√≠tulo elegante con logo de Paradisus.</li>
      <li> üëå Gracias por ser parte de la Mejoraüòä.</li>
    </ul>
    <button id="cerrar-modal">Cerrar</button>
  </div>
</div>

<!-- Script del modal -->
<script>
document.addEventListener('DOMContentLoaded', () => {
  const modal = document.getElementById('modal-mejoras');
  const btnCerrar = document.getElementById('cerrar-modal');

  modal.classList.add('activo');

  btnCerrar.addEventListener('click', () => {
    modal.classList.remove('activo');
  });

  modal.addEventListener('click', (e) => {
    if (e.target === modal) {
      modal.classList.remove('activo');
    }
  });
});
</script>
    <script>
function hacerZoom(src) {
  const overlay = document.getElementById('zoom-overlay');
  const img = document.getElementById('zoom-img');
  img.src = src;
  overlay.style.display = 'flex';        // mostrar
  overlay.classList.remove('visor-oculto');
  overlay.setAttribute('aria-hidden', 'false');
}  
function cerrarZoom(event) {
  const overlay = document.getElementById('zoom-overlay');
  // Cerrar si: no hay evento, o se hace clic en el fondo, o en el bot√≥n de cerrar
  if (!event || event.target === overlay || event.target.id === 'zoom-close') {
    overlay.style.display = 'none';      // ocultar
    overlay.classList.add('visor-oculto');
    overlay.setAttribute('aria-hidden', 'true');
    document.getElementById('zoom-img').src = '';
  }
}

// Cerrar con tecla ESC
document.addEventListener('keydown', (ev) => {
  if (ev.key === 'Escape') cerrarZoom();
});
</script>



<script>
// ===== Carga JSON (tal cual) =====
window.habitacionesData = window.habitacionesData || null;
async function ensureHabitacionesData(){
  if(!window.habitacionesData){
    const resp = await fetch('habitaciones.json', {cache:'no-store'});
    window.habitacionesData = await resp.json();
  }
  return window.habitacionesData;
}

// ===== Utilidades espec√≠ficas a tu JSON =====
function getTipoCama(h){
  // En tu JSON viene como "K" o "D" (campo tipo_cama)
  const v = (h.tipo_cama || '').toString().toUpperCase();
  if (v === 'K' || v === 'D') return v;
  // Fallback por si un d√≠a viene texto
  const txt = [h.titulo||'', h.descripcion||'', ...(h.caracteristicas||[])].join(' ').toUpperCase();
  if (/\bKING\b|KING SIZE|\bKS\b/.test(txt)) return 'K';
  if (/\bDOUBLE\b|\bDOBLE\b|\bMATRIMONIAL\b|\bMATRI\b|2\s*DBL/.test(txt)) return 'D';
  return '';
}

function prefijoRecepcion(h){
  // Deriva C/S del c√≥digo en el t√≠tulo (C2V, C2W, S6E, SE1, SE2, SE4, ...)
  const t = (h.titulo || '').toUpperCase();
  const m = t.match(/\b([CS](?:E)?\d*[A-Z]?)\b/); // S6E, SE1, C2V, C2W...
  if (m && m[1]) return m[1].startsWith('S') ? 'S' : 'C';
  // Fallback: por categor√≠a
  const cat = (h.categoria||'').toLowerCase();
  return cat.includes('the reserve') ? 'S' : 'C';
}

function esHandicap(h){
  // Tu JSON trae booleano 'discapacidad'
  return h.discapacidad === true;
}

function tieneCocineta(h){
  if (h.cocineta === true) return true;
  const list = (h.caracteristicas || []).map(x => String(x).toLowerCase());
  return list.some(x => /\bcocineta\b|kitchenette|\bcocina\b/.test(x));
}

function torreDe(numStr){
  const s = String(numStr).trim();
  const t = parseInt(s[0], 10);
  return [1,2,3,4].includes(t) ? t : 0;
}

// ===== Refs =====
const selCategoria = document.getElementById('filtro-categoria');
const selCama      = document.getElementById('filtro-cama');
const selPrefijo   = document.getElementById('filtro-prefijo');
const cbHandicap   = document.getElementById('filtro-handicap');
const cbCocineta   = document.getElementById('filtro-cocineta');
const coincidenciasEl = document.getElementById('total-coincidencias-categoria');
const resumenEl    = document.getElementById('totales-resumen');
const tablaEl      = document.getElementById('totales-tabla');

function renderTabla(stats){
  if(!tablaEl) return;
  const t = stats.towers;
  tablaEl.innerHTML = `
    <table>
      <thead><tr><th>Torre</th><th>K</th><th>D</th><th>Total</th></tr></thead>
      <tbody>
        ${[1,2,3,4].map(i => `
          <tr><td>${i}</td><td>${t[i].K}</td><td>${t[i].D}</td><td><strong>${t[i].total}</strong></td></tr>
        `).join('')}
      </tbody>
    </table>`;
}

async function aplicarFiltrosBoss(){
  const data = await ensureHabitacionesData();
  const categoria = (selCategoria?.value || '').trim().toLowerCase();
  const cama      = (selCama?.value || '').toUpperCase();   // "" | K | D
  const prefijo   = (selPrefijo?.value || '').toUpperCase(); // "" | C | S
  const fHC       = !!cbHandicap?.checked;
  const fCoc      = !!cbCocineta?.checked;

  let matches = 0;
  const stats = {
    overall:{K:0,D:0,total:0},
    towers:{1:{K:0,D:0,total:0},2:{K:0,D:0,total:0},3:{K:0,D:0,total:0},4:{K:0,D:0,total:0}},
    flags:{reserve:0, handicap:0, cocineta:0}
  };

  // Recorremos cada bot√≥n de habitaci√≥n
  document.querySelectorAll('.habitacion-btn').forEach(btn => {
    const num = btn.dataset.num || btn.textContent.trim();
    const h = data[num];
    if(!h){ btn.classList.add('filtro-inactivo'); btn.classList.remove('filtro-activo'); return; }

    let ok = true;
    if(categoria){ ok = ok && ((h.categoria||'').toLowerCase() === categoria); }
    if(cama){
      const tc = getTipoCama(h);
      ok = ok && (tc === cama);
    }
    if(prefijo){
      const p = prefijoRecepcion(h);
      ok = ok && (p === prefijo);
    }
    if(fHC){ ok = ok && esHandicap(h); }
    if(fCoc){ ok = ok && tieneCocineta(h); }

    btn.classList.toggle('filtro-inactivo', !ok);
    btn.classList.toggle('filtro-activo', ok);

    if(ok){
      matches++;
      const kd = (getTipoCama(h) === 'K') ? 'K' : 'D';
      stats.overall[kd]++; stats.overall.total++;
      const t = torreDe(num);
      if(t){ stats.towers[t][kd]++; stats.towers[t].total++; }
      if (prefijoRecepcion(h) === 'S') stats.flags.reserve++;
      if (esHandicap(h)) stats.flags.handicap++;
      if (tieneCocineta(h)) stats.flags.cocineta++;
    }
  });

  if(coincidenciasEl) coincidenciasEl.textContent = matches;
  if(resumenEl) resumenEl.textContent =
    `K: ${stats.overall.K} ¬∑ D: ${stats.overall.D} ¬∑ Total: ${stats.overall.total} ‚Äî `+
    `Reserve: ${stats.flags.reserve} ¬∑ ‚ôø: ${stats.flags.handicap} ¬∑ Cocineta: ${stats.flags.cocineta}`;
  renderTabla(stats);
}

// Eventos
[selCategoria, selCama, selPrefijo, cbHandicap, cbCocineta].forEach(el => {
  if(el) el.addEventListener('change', aplicarFiltrosBoss);
});
document.getElementById('btn-limpiar-filtro')?.addEventListener('click', () => {
  if(selCategoria) selCategoria.value = '';
  if(selCama) selCama.value = '';
  if(selPrefijo) selPrefijo.value = '';
  if(cbHandicap) cbHandicap.checked = false;
  if(cbCocineta) cbCocineta.checked = false;
  aplicarFiltrosBoss();
});

document.addEventListener('DOMContentLoaded', aplicarFiltrosBoss);

// === Video helpers (handicap) ===
function stopVideoHabitacion(){
  try{
    const iframe = document.getElementById('video-embed');
    const mp4 = document.getElementById('video-mp4');
    if (mp4){ mp4.pause?.(); mp4.removeAttribute('src'); mp4.load?.(); }
    if (iframe){ iframe.src = ''; }
  }catch(e){}
}
function normalizarEmbed(u){
  try{
    if(u.includes('youtu.be/')){ const id = u.split('/').pop().split(/[?&#]/)[0]; return `https://www.youtube.com/embed/${id}`; }
    if(u.includes('watch?v=')){ const id = new URL(u).searchParams.get('v'); return `https://www.youtube.com/embed/${id}`; }
    if(u.includes('youtube.com/embed/')) return u;
    if(u.includes('vimeo.com/')){ const id = u.split('/').pop().split(/[?&#]/)[0]; return `https://player.vimeo.com/video/${id}`; }
  }catch(e){}
  return u;
}

function setVideoHabitacion(url){
  const box = document.getElementById('video-habitacion');
  const iframe = document.getElementById('video-embed');
  const mp4 = document.getElementById('video-mp4');
  if(!box || !iframe || !mp4) return;

  // Reset
  box.hidden = true;
  iframe.hidden = true; iframe.src = "";
  mp4.hidden = true; mp4.removeAttribute('src'); mp4.load?.();

  if(!url) return;

  const u = String(url).trim();
  if(/youtu\.be|youtube\.com|vimeo\.com/i.test(u)){
    iframe.src = normalizarEmbed(u);
    iframe.hidden = false;
    box.hidden = false;
    return;
  }
  if(/\.(mp4)(\?|#|$)/i.test(u)){
    mp4.src = u;
    mp4.hidden = false;
    box.hidden = false;

    // Click abre zoom como las im√°genes
    try{ mp4.onclick = (ev)=>{ ev.stopPropagation(); abrirZoomVideo(mp4.currentSrc || mp4.src); }; }catch(_e){}
    return;
  }
}

// Mapa de videos por habitaci√≥n (handicap)
window.VIDEOS_HAB = window.VIDEOS_HAB || {
  "4318": "https://res.cloudinary.com/dor6za85u/video/upload/v1754942483/Ba%C3%B1o_Handicap_i1r6cg.mp4", // pega aqu√≠ el enlace del video
  "4321": "https://res.cloudinary.com/dor6za85u/video/upload/v1754942483/Ba%C3%B1o_Handicap_i1r6cg.mp4", // pega aqu√≠ el enlace del video
  "4325": "https://res.cloudinary.com/dor6za85u/video/upload/v1754942483/Ba%C3%B1o_Handicap_i1r6cg.mp4", // pega aqu√≠ el enlace del video
  "4328": ""  // pega aqu√≠ el enlace del video
};
// URL por defecto si quieres usar 1 solo video para las 4
window.HANDICAP_VIDEO_URL = "https://res.cloudinary.com/dor6za85u/video/upload/v1754942483/Ba%C3%B1o_Handicap_i1r6cg.mp4"; // <-- opcional: pega aqu√≠ un enlace (YouTube/Vimeo o .mp4)


// === Zoom de Video ===
function abrirZoomVideo(src){
  const overlay = document.getElementById('video-zoom-overlay');
  const zv = document.getElementById('zoom-video');
  if(!overlay || !zv) return;
  // reset
  zv.pause?.(); zv.removeAttribute('src'); zv.load?.();
  zv.setAttribute('playsinline','');
  zv.setAttribute('muted',''); // autoplay seguro; usuario puede activar sonido
  zv.setAttribute('autoplay','');
  zv.muted = true;
  zv.src = src;
  overlay.classList.add('activo');
  overlay.setAttribute('aria-hidden','false');
  const p = zv.play?.(); if (p && typeof p.catch==='function') p.catch(()=>{});
}
function cerrarZoomVideo(){
  const overlay = document.getElementById('video-zoom-overlay');
  const zv = document.getElementById('zoom-video');
  if(!overlay || !zv) return;
  zv.pause?.(); zv.removeAttribute('src'); zv.load?.();
  overlay.classList.remove('activo');
  overlay.setAttribute('aria-hidden','true');
}
// cerrar por click fuera o ESC
document.addEventListener('DOMContentLoaded', () => {
  const overlay = document.getElementById('video-zoom-overlay');
  overlay?.addEventListener('click', (e)=>{ if(e.target===overlay) cerrarZoomVideo(); });
  document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') cerrarZoomVideo(); });
});

</script>

<!-- Overlay de ZOOM para video -->
<div id="video-zoom-overlay" class="video-zoom-overlay" aria-hidden="true">
  <video id="zoom-video" controls playsinline muted></video>
</div>


<!-- Fallback inteligente para descargar el PDF en GitHub Pages -->
<script>
document.addEventListener('DOMContentLoaded', () => {
  const btn = document.getElementById('btn-descargar-pdf');
  if (!btn) return;

  const base = new URL('.', location.href).href;

  const candidates = [
    'introduccion_paradisus_2025.pdf',
    'Introducci√≥n Proyecto Cat√°logo de Habitaciones ¬∑ Paradisus desarrollado por Luis Hernaldo 2025.pdf',
    'Introduccion Proyecto Catalogo de Habitaciones - Paradisus desarrollado por Luis Hernaldo 2025.pdf',
    'assets/introduccion_paradisus_2025.pdf',
    'pdf/introduccion_paradisus_2025.pdf'
  ];

  async function headOk(url){
    try{
      const res = await fetch(url, { method:'HEAD', cache:'no-store' });
      return res.ok;
    }catch(_){ return false; }
  }

  btn.addEventListener('click', async (e) => {
    // Permite ctrl/cmd click normal
    if (e.metaKey || e.ctrlKey || e.shiftKey || e.altKey) return;
    e.preventDefault();

    for (const c of candidates){
      const url = new URL(encodeURI(c), base).href;
      if (await headOk(url)){
        window.open(url, '_blank', 'noopener');
        return;
      }
    }
    alert('No se encontr√≥ el PDF. Sube una copia llamada "introduccion_paradisus_2025.pdf" en el mismo folder del index o usa la carpeta assets/pdf indicada.');
  });
});
</script>


<script>
document.addEventListener("DOMContentLoaded", function() {
    const videos = document.querySelectorAll(".modal-contenido video");
    videos.forEach(video => {
        video.addEventListener("click", () => {
            video.classList.toggle("zoomed");
        });
    });
});
</script>


<script>
(function() {
  try {
    var modal = document.getElementById('modal-mejoras');
    var btnCerrar = document.getElementById('cerrar-modal');
    if (modal && btnCerrar) {
      var observer = new MutationObserver(function(muts){
        for (var i=0; i<muts.length; i++) {
          if (muts[i].attributeName === 'class') {
            var c = modal.className || '';
            if (c.indexOf('abierto') !== -1) {
              setTimeout(function(){ try { btnCerrar.focus(); } catch(e){} }, 0);
            }
          }
        }
      });
      observer.observe(modal, { attributes: true });
    }
  } catch(e) {}
})();
</script>

<script>
document.addEventListener('DOMContentLoaded', () => {
  document.querySelectorAll('.habitacion-btn').forEach(btn => {
    const n = btn.getAttribute('data-num') || btn.textContent.trim();
    if(n && !btn.hasAttribute('onclick')){
      btn.setAttribute('onclick', `mostrarInfo('${n}')`);
    }
  });
  // ESC to close zoom if function exists
  document.addEventListener('keydown', e=>{
    if(e.key === 'Escape' && typeof cerrarZoom === 'function'){ cerrarZoom(e); }
  });
});
</script>

<script>
/*! HK Inventario (modal de vistas) ‚Äî aislado para index */
(function(){
  const HK_PIN = '246810';                // Acceso Housekeeping (temporal)
  const SESSION_KEY = 'hk_inv_session';
  const TTL = 8*60*60*1000;               // 8h

  let HAB_ACTUAL = null;                  // N√∫mero de habitaci√≥n activa

  function now(){ return Date.now(); }
  function hasSession(){ const t = +sessionStorage.getItem(SESSION_KEY)||0; return (now()-t) < TTL; }
  function setSession(){ sessionStorage.setItem(SESSION_KEY, String(now())); }
  function pedirPIN(ok){
    if(hasSession()) return ok && ok();
    const p = prompt('Acceso Housekeeping ‚Äî PIN:');
    if(p === HK_PIN){ setSession(); ok && ok(); }
  }

  // Detectamos cuando se abre el modal de VISTAS (no tocamos otros modales)
  // Criterios: presencia de tarjetas .bloque-imagen dentro de un contenedor tipo modal.
  const MODAL_SEL = '.modal-contenido, .modal, .modal-content, .lightbox, .galeria-modal, .modal-vistas, [role="dialog"]';

  function isRoomViewsModal(root){
    if(!root) return false;
    // Debe contener al menos una tarjeta de imagen
    if(!root.querySelector('.bloque-imagen')) return false;
    // Extra: suele contener texto "Habitaci√≥n" en el encabezado
    const txt = (root.textContent||'').toLowerCase();
    if(!txt.includes('habitaci√≥n')) return false;
    return true;
  }

  function ensureSidePanel(root){
    let side = root.querySelector('.hk-inv-side');
    if(side) return side;
    side = document.createElement('aside');
    side.className = 'hk-inv-side';
    side.innerHTML = '<h3>Inventario</h3><div class="hk-inv-muted" id="hk-side-status">Cargando‚Ä¶</div><div id="hk-side-body" class="hk-inv-muted">Panel listo.</div>';
    root.appendChild(side);
    return side;
  }

  function obtenerDatosHabitacion(num){
    const fuentes = ['habitaciones','HABITACIONES','habitacionesData','dataHabitaciones'];
    let datos = null;
    for(const k of fuentes){ const ref = window[k]; if(ref && typeof ref==='object' && ref[num]){ datos = ref[num]; break; } }
    const panel = document.querySelector('.panel-info,#panel-info');
    let tipo = (datos && datos.tipo_cama) ? String(datos.tipo_cama).toUpperCase() : 'K';
    if(panel){ const m = (panel.textContent||'').match(/Tipo\s*de\s*cama\s*:\s*([KD])/i); if(m) tipo = m[1].toUpperCase(); }
    let catInv = (datos && (datos.categoria_inventario || datos.categoriaInventario)) || 'Normal';
    return { habitacion: String(num||'‚Äî'), categoria: catInv, tipo_cama: tipo };
  }

  function mountInventario(side, datos){
    const status = side.querySelector('#hk-side-status');
    const body = side.querySelector('#hk-side-body');
    status.textContent = 'Hab. ' + datos.habitacion + ' ¬∑ ' + datos.categoria + ' ¬∑ Cama ' + datos.tipo_cama;
    if(window.Inventario && typeof window.Inventario.mountInventario === 'function'){
      const cont = document.createElement('div');
      body.replaceWith(cont);
      window.Inventario.mountInventario(cont, {
        habitacion: datos.habitacion,
        categoria: datos.categoria,
        tipo_cama: datos.tipo_cama
      });
    }else{
      body.innerHTML = 'Incluye <code>inventario.js</code> para ver el formulario.';
    }
  }

  function injectButton(root){
    // Elegimos la primera tarjeta de imagen del modal
    const card = root.querySelector('.bloque-imagen, figure, .card-imagen, .gallery-item');
    if(!card) return;
    if(card.querySelector('.hk-inv-btn')) return; // no duplicar
    const btn = document.createElement('button');
    btn.className = 'hk-inv-btn';
    btn.type = 'button';
    btn.textContent = 'Inventario';
    btn.addEventListener('click', function(){
      const datos = obtenerDatosHabitacion(HAB_ACTUAL);
      const abrir = ()=>{
        const side = ensureSidePanel(root);
        side.classList.add('hk-open');
        mountInventario(side, datos);
        btn.textContent = 'Inventario (abierto)';
      };
      pedirPIN(abrir);
    });
    card.appendChild(btn);
  }

  // Mutaci√≥n del DOM: cuando aparezca un modal de vistas, inyectamos
  const mo = new MutationObserver((records)=>{
    records.forEach(rec=>{
      for(const node of rec.addedNodes){
        if(!(node instanceof Element)) continue;
        const root = node.matches && node.matches(MODAL_SEL) ? node : node.querySelector && node.querySelector(MODAL_SEL);
        if(root && isRoomViewsModal(root)){
          injectButton(root);
        }
      }
    });
  });
  mo.observe(document.documentElement, { childList:true, subtree:true });

  // Parcheamos mostrarInfo para registrar habitaci√≥n activa
  function patchMostrarInfo(){
    if(typeof window.mostrarInfo !== 'function') return false;
    if(window.mostrarInfo.__hkPatched) return true;
    const orig = window.mostrarInfo;
    window.mostrarInfo = async function(num){
      HAB_ACTUAL = num;
      return await orig.apply(this, arguments);
    };
    window.mostrarInfo.__hkPatched = true;
    return true;
  }
  if(!patchMostrarInfo()){
    const t = setInterval(()=>{ if(patchMostrarInfo()) clearInterval(t); }, 300);
  }
})();
</script>
<!-- HK-INVENTARIO-END -->


<script>
// Handler global para Inventario en panel de detalle
window.HK_CTX = window.HK_CTX || { habitacionActual: null };
async function handleInventarioClick(num){
  try{ window.HK_CTX.habitacionActual = String(num); }catch(e){}
  // Valida PIN (usa tu propio flujo si ya existe)
  const KEY='HK_PIN_OK';
  try { if (sessionStorage.getItem(KEY)==='1') { /* ok */ } else {
    const pin = prompt('PIN de Housekeeping:');
    if(pin==='246810'){ sessionStorage.setItem(KEY,'1'); }
    else { alert('PIN incorrecto.'); return; }
  }} catch(e){}
  // Abre panel inventario (integra tu funci√≥n real si existe)
  if (typeof window.abrirInventarioHK === 'function') {
    return window.abrirInventarioHK(num);
  }
  const panel = document.getElementById('panel-inventario') || document.querySelector('.hk-inventario-panel');
  if (panel){
    panel.classList.add('abierto','activo');
    const lbl = panel.querySelector('#inv-room-label'); if (lbl) lbl.textContent = 'Habitaci√≥n ' + num;
    const hidden = panel.querySelector('input[name="habitacion_num"]'); if (hidden) hidden.value = num;
  } else {
    alert('Inventario para Habitaci√≥n ' + num + ' (stub). Integra abrirInventarioHK(num).');
  }
}
</script>

<script>
// Override para integrar flujo multiusuario + Sillas
(function(){
  window.__HK_afterLogin = null;
  const _get = (id)=>document.getElementById(id);

  function tryOpenSillas(){
    // Usa la funci√≥n ya definida en el m√≥dulo de sillas
    if (typeof openSillas === "function") {
      openSillas();
      return true;
    }
    return false;
  }

  window.handleInventarioClick = function(num){
    try{ window.HK_CTX = window.HK_CTX || {}; window.HK_CTX.habitacionActual = String(num); }catch(e){}
    // Reflejar selecci√≥n en nuestro m√≥dulo
    try {
      window.HK_CURRENT_ROOM = String(num);
      const btnC = _get("hk-comenzar");
      if (btnC) btnC.style.display = "inline-flex";
    }catch(e){}

    // Si hay sesi√≥n activa -> abre sillas directo
    try {
      if (typeof getSession === "function" && typeof isActive === "function"){
        const s = getSession();
        if (isActive(s)){ tryOpenSillas(); return; }
      }
    } catch(e){}

    // Si no hay sesi√≥n: abrir modal y esperar login para abrir sillas
    try {
      if (typeof openPIN === "function"){ openPIN(); }
      window.__HK_afterLogin = function(){
        tryOpenSillas();
      };
    } catch(e){}
  };
})();
</script>


<!-- Modal PIN elegante -->
<div id="hkpin2-overlay" class="hkpin2-overlay" role="dialog" aria-modal="true" aria-labelledby="hkpin2-title">
  <div class="hkpin2">
    <h3 id="hkpin2-title">Acceso Housekeeping</h3>
    <p class="sub">Ingresa tu PIN para abrir el inventario de la habitaci√≥n seleccionada.</p>
    <div class="row">
      <input id="hkpin2-input" class="hkpin2-input" type="password" placeholder="PIN" inputmode="numeric" autocomplete="one-time-code" />
      <button id="hkpin2-toggle" class="hkpin2-toggle" aria-label="Mostrar/ocultar">üëÅÔ∏è</button>
    </div>
    <div class="hkpin2-actions">
      <button id="hkpin2-cancel" class="hkbtn">Cancelar</button>
      <button id="hkpin2-ok" class="hkbtn primary">Ingresar</button>
    </div>
  </div>
</div>


<script>
window.HK_CTX = window.HK_CTX || { habitacionActual: null };
(function(){
  const OVER = document.getElementById('hkpin2-overlay');
  const INP  = document.getElementById('hkpin2-input');
  const OK   = document.getElementById('hkpin2-ok');
  const CAN  = document.getElementById('hkpin2-cancel');
  const TOG  = document.getElementById('hkpin2-toggle');
  const KEY  = 'HK_PIN_OK';
  const PIN  = '246810'; // reemplaza por tu PIN o validaci√≥n real

  function show(){ OVER.style.display='flex'; setTimeout(()=>INP?.focus(), 40); }
  function hide(){ OVER.style.display='none'; }

  function pedirPINModal(){
    return new Promise((resolve)=>{
      function cleanup(){
        OK.removeEventListener('click', onok);
        CAN.removeEventListener('click', oncancel);
        TOG.removeEventListener('click', ontoggle);
        INP.removeEventListener('keydown', onkey);
      }
      function onok(){
        const val = INP.value.trim();
        if(val === PIN){ try{ sessionStorage.setItem(KEY,'1'); }catch(e){} cleanup(); hide(); resolve(true); }
        else { INP.select(); INP.focus(); }
      }
      function oncancel(){ cleanup(); hide(); resolve(false); }
      function onkey(e){ if(e.key==='Enter') onok(); if(e.key==='Escape') oncancel(); }
      function ontoggle(){ INP.type = (INP.type==='password' ? 'text' : 'password'); INP.focus(); }

      INP.value='';
      OK.addEventListener('click', onok);
      CAN.addEventListener('click', oncancel);
      TOG.addEventListener('click', ontoggle);
      INP.addEventListener('keydown', onkey);
      show();
    });
  }

  // Reemplaza el flujo del bot√≥n Inventario
  window.handleInventarioClick = async function(num){
    try { window.HK_CTX.habitacionActual = String(num); } catch(e){}
    try { if (sessionStorage.getItem(KEY) === '1') return window.abrirInventarioHK?.(num); } catch(e){}
    const ok = await pedirPINModal();
    if(!ok) return;
    if (typeof window.abrirInventarioHK === 'function') return window.abrirInventarioHK(num);
    // Fallback simple
    alert('Inventario para Habitaci√≥n ' + num + ' (stub). Integra abrirInventarioHK(num).');
  };
})();
</script>


<button id="hk-comenzar" class="hk-comenzar" type="button">‚ñ∂Ô∏è Comenzar</button>

<div id="hk-sillas-overlay" class="hk-modal-overlay" role="dialog" aria-modal="true" aria-labelledby="hk-sillas-title">
  <div class="hk-modal">
    <h3 id="hk-sillas-title">Sillas de habitaci√≥n <span id="hk-room-label"></span></h3>
    <div class="hk-badge-usuario" id="hk-usuario-label"></div>
    <div id="hk-ultima-actualizacion" class="hk-ultima-act">Sin registros previos.</div>
    <div id="hk-hist-toggle" class="hk-hist-toggle">üïò Ver historial</div>
    <div id="hk-hist" class="hk-hist">
      <div id="hk-hist-list"></div>
    </div>


    <div class="hk-form-row"><label for="hk-sillas-cantidad">Cantidad de sillas</label><div class="hk-stepper"><button type="button" class="hk-stepper-dec" aria-label="Disminuir">‚àí</button><input id="hk-sillas-cantidad" type="number" min="0" max="6" step="1" value="0"><button type="button" class="hk-stepper-inc" aria-label="Aumentar">+</button></div></div>
    <div class="hk-form-row">
      <label for="hk-sillas-notas">Notas</label>
      <textarea id="hk-sillas-notas" placeholder="Observaciones (opcional)"></textarea>
    </div>

    <div class="hk-actions">
      <button type="button" class="hk-btn" id="hk-sillas-cancelar">Cancelar</button>
      <button type="button" class="hk-btn primary" id="hk-sillas-guardar">Guardar</button>
    </div>
  </div>
</div>


<script>
/* ===== HK Multiusuario + Registro de Sillas ===== */
(function(){
  // --- Usuarios proporcionados ---
  const USERS = {
    "3068694": { nombre: "Cifuentes Mar√≠a Dolores", rol: "SUP HSK" },
    "3071925": { nombre: "Amezquita Valencia Zinia Itzel", rol: "SUP HSK" },
    "3075393": { nombre: "Jim√©nez L√≥pez Juana Marisela", rol: "SUP HSK" },
    "3077512": { nombre: "Florencio Garc√≠a Cynthia Ximena", rol: "SUP HSK" },
    "3072167": { nombre: "Ju√°rez Pineda Luis Hernaldo", rol: "ASIST. ADMVO" },
    "3062148": { nombre: "P√©rez Otero Silvia", rol: "ASIST. OPERATIVA" },
    "3067888": { nombre: "Migoni Garc√≠a Manuel", rol: "AMA DE LLAVES EJEC" }
  };

  const STORAGE_KEY = "HK_INV_SESSION_V2";
  const LOG_KEY = "HK_INV_LOGS";
  const ROOMS_KEY = "HK_ROOM_ITEMS"; // Persistencia por habitaci√≥n
  const DURATION_MS = 8 * 60 * 60 * 1000;

  const btnInventario = document.getElementById("btn-inventario");
  const overlayPIN = document.getElementById("hkpin2-overlay");
  const inputPIN = document.getElementById("hkpin2-input");

  // UI para sillas
  const btnComenzar = document.getElementById("hk-comenzar");
  const sillasOverlay = document.getElementById("hk-sillas-overlay");
  const roomLabel = document.getElementById("hk-room-label");
  const userLabel = document.getElementById("hk-usuario-label");
  const inputCant = document.getElementById("hk-sillas-cantidad");
  const inputNotas = document.getElementById("hk-sillas-notas");
  const btnGuardar = document.getElementById("hk-sillas-guardar");
  /* --- Login helpers & wiring (overlay PIN usado como matr√≠cula) --- */
  function validateMatricula(m){
    return !!USERS[(m||"").trim()];
  }
  window.HK_validate = validateMatricula;

  // Abre/cierra el modal de matr√≠cula (overlay existente)
  function openPIN(){
    if(!overlayPIN) return;
    overlayPIN.style.display = "flex";
    setTimeout(()=>overlayPIN.classList.add("activo"), 0);
    if (inputPIN){ inputPIN.type="text"; inputPIN.placeholder="Matr√≠cula"; inputPIN.value=""; inputPIN.focus(); }
  }
  function closePIN(){
    if(!overlayPIN) return;
    overlayPIN.classList.remove("activo");
    setTimeout(()=>overlayPIN.style.display = "none", 200);
  }

  // Click en Inventario: si sesi√≥n activa, abre panel si aplica; si no, pide matr√≠cula
  if (btnInventario){
    btnInventario.addEventListener("click", ()=>{
      const sess = getSession();
      if (isActive(sess)){
        // acceso directo (si usas panel lateral)
        // const side = document.querySelector(".hk-inv-side"); if(side) side.classList.add("hk-open");
      } else {
        openPIN();
      }
    });
  }

  // Enter en input de matr√≠cula
  if (inputPIN){
    inputPIN.addEventListener("keydown", function(ev){
      if (ev.key === "Enter"){
        const m = (inputPIN.value||"").trim();
        if (validateMatricula(m)){
          setSession(m);
        closePIN();
        if (window.__HK_afterLogin){ try{ window.__HK_afterLogin(); }catch(e){} window.__HK_afterLogin=null; }
if (window.__HK_afterLogin){ try{ window.__HK_afterLogin(); }catch(e){} window.__HK_afterLogin=null; }
} else {
          inputPIN.setCustomValidity("Matr√≠cula no reconocida");
          inputPIN.reportValidity();
          setTimeout(()=>inputPIN.setCustomValidity(""), 1800);
        }
      }
    });
  }

  // Click en bot√≥n Aceptar del modal de matr√≠cula
  (function(){
    const btnOK = document.getElementById("hkpin2-ok");
    if (btnOK && inputPIN){
      btnOK.addEventListener("click", function(){
        const m = (inputPIN.value||"").trim();
        if (validateMatricula(m)){
          setSession(m);
        closePIN();
        if (window.__HK_afterLogin){ try{ window.__HK_afterLogin(); }catch(e){} window.__HK_afterLogin=null; }
if (window.__HK_afterLogin){ try{ window.__HK_afterLogin(); }catch(e){} window.__HK_afterLogin=null; }
} else {
          inputPIN.setCustomValidity("Matr√≠cula no reconocida");
          inputPIN.reportValidity();
          setTimeout(()=>inputPIN.setCustomValidity(""), 1800);
        }
      });
    }
  })();

  const MAX_HISTORY = 50;
  const elUltima = document.getElementById("hk-ultima-actualizacion");
  const elHistToggle = document.getElementById("hk-hist-toggle");
  const elHist = document.getElementById("hk-hist");
  const elHistList = document.getElementById("hk-hist-list");

  function formatFecha(ts){
    try { return new Date(ts).toLocaleString("es-MX", { dateStyle:"medium", timeStyle:"short" }); }
    catch(e){ return new Date(ts).toLocaleString(); }
  }

  function getRoomData(num){
    const data = loadRoomsData();
    return data[num] || {};
  }
  function setRoomData(num, payload){
    const data = loadRoomsData();
    data[num] = Object.assign({}, data[num]||{}, payload);
    saveRoomsData(data);
  }

  function renderUltima(num){
    const d = getRoomData(num);
    const last = (d.sillas_historial && d.sillas_historial.length) ? d.sillas_historial[d.sillas_historial.length-1] : d.sillas;
    if (last && typeof last.ts === "number"){
      elUltima.textContent = `√öltima actualizaci√≥n: ${formatFecha(last.ts)} ¬∑ ${last.nombre}`;
    } else {
      elUltima.textContent = "Sin registros previos.";
    }
  }

  function renderHistorial(num){
    const d = getRoomData(num);
    const hist = (d.sillas_historial||[]).slice().reverse(); // mostrar recientes primero
    elHistList.innerHTML = "";
    if (!hist.length){
      elHistList.innerHTML = "<div class='hk-hist-item'><div class='hk-hist-meta'>No hay historial a√∫n.</div></div>";
      return;
    }
    hist.forEach((entry, i)=>{
      const wrap = document.createElement("div");
      wrap.className = "hk-hist-item";
      const meta = document.createElement("div");
      meta.className = "hk-hist-meta";
      meta.textContent = `${formatFecha(entry.ts)} ¬∑ ${entry.nombre} ¬∑ Cant: ${entry.cantidad}` + (entry.notas ? ` ¬∑ "${entry.notas}"` : "");
      const actions = document.createElement("div");
      actions.className = "hk-hist-actions";
      const restore = document.createElement("button");
      restore.textContent = "Restaurar";
      restore.addEventListener("click", ()=>{
        // Solo carga los valores al formulario; el guardado crea una nueva versi√≥n
        inputCant.value = entry.cantidad;
        inputNotas.value = entry.notas || "";
      });
      actions.appendChild(restore);
      wrap.appendChild(meta);
      wrap.appendChild(actions);
      elHistList.appendChild(wrap);
    });
  }

  // Toggle del historial
  if (elHistToggle){
    elHistToggle.addEventListener("click", ()=>{
      const isOpen = elHist.style.display === "block";
      elHist.style.display = isOpen ? "none" : "block";
      elHistToggle.textContent = isOpen ? "üïò Ver historial" : "üóÇÔ∏è Ocultar historial";
      if (!isOpen && HK_CURRENT_ROOM){
        renderHistorial(HK_CURRENT_ROOM);
      }
    });
  }

  const btnCancelar = document.getElementById("hk-sillas-cancelar");

  // Exponer helpers a window si no existen
  function now(){ return Date.now(); }
  function fmt(t){ return new Date(t).toLocaleString("es-MX"); }
  function getSession(){
    try{ const raw = localStorage.getItem(STORAGE_KEY); return raw ? JSON.parse(raw) : null; }catch(e){ return null; }
  }
  function isActive(sess){
    return sess && USERS[sess.matricula] && sess.expiresAt > now();
  }
  function setSession(matricula){
    const startedAt = now();
    const expiresAt = startedAt + DURATION_MS;
    const perfil = USERS[matricula];
    const sess = { matricula, nombre: perfil.nombre, rol: perfil.rol, startedAt, expiresAt };
    localStorage.setItem(STORAGE_KEY, JSON.stringify(sess));
    return sess;
  }
  function audit(action, payload){
    try {
      const raw = localStorage.getItem(LOG_KEY);
      const arr = raw ? JSON.parse(raw) : [];
      const sess = getSession();
      const base = isActive(sess) ? { matricula: sess.matricula, nombre: sess.nombre, rol: sess.rol } : {};
      arr.push(Object.assign({ ts: now(), action }, base, (payload||{})));
      localStorage.setItem(LOG_KEY, JSON.stringify(arr));
    } catch(e){}
  }
  window.getHKSession = window.getHKSession || function(){ const s=getSession(); return isActive(s)?s:null; };
  window.auditHK = window.auditHK || audit;

  // Detectar habitaci√≥n seleccionada (delegaci√≥n de eventos)
  let HK_CURRENT_ROOM = null;
  document.addEventListener("click", (e)=>{
    const btn = e.target.closest && e.target.closest(".habitacion-btn");
    if(btn && btn.dataset.num){
      HK_CURRENT_ROOM = btn.dataset.num;
      // Mostrar bot√≥n comenzar si hay sesi√≥n activa
      const sess = getSession();
      btnComenzar.style.display = isActive(sess) ? "inline-flex" : "none";
    }
  });

  // Al cargar, marcar habitaciones ya registradas (sillas)
  function loadRoomsData(){
    try{ return JSON.parse(localStorage.getItem(ROOMS_KEY)||"{}"); }catch(e){ return {}; }
  }
  function saveRoomsData(data){
    localStorage.setItem(ROOMS_KEY, JSON.stringify(data));
  }
  function markRegisteredRooms(){
    const data = loadRoomsData();
    document.querySelectorAll(".habitacion-btn[data-num]").forEach(b=>{
      const num = b.dataset.num;
      if (data[num] && data[num].sillas && typeof data[num].sillas.cantidad === "number"){
        b.classList.add("inventario-ok");
      }
    });
  }
  markRegisteredRooms();

  // Mostrar modal de sillas
  function openSillas(){
    if(!HK_CURRENT_ROOM){
      alert("Selecciona una habitaci√≥n primero.");
      return;
    }
    const sess = getSession();
    if(!isActive(sess)){
      alert("Inicia sesi√≥n con tu matr√≠cula para registrar.");
      return;
    }
    roomLabel.textContent = "¬∑ " + HK_CURRENT_ROOM;
    userLabel.textContent = `Hola ${sess.nombre.split(" ")[0]}, gusto en verte. ¬øQu√© vamos a registrar hoy? (${new Date().toLocaleDateString("es-MX", { weekday:'long', year:'numeric', month:'long', day:'numeric' })})`;
    // cargar valores previos si existen
    const data = loadRoomsData();
    const prev = (data[HK_CURRENT_ROOM] && data[HK_CURRENT_ROOM].sillas) ? data[HK_CURRENT_ROOM].sillas : null;
    inputCant.value = prev ? prev.cantidad : 0;
    inputNotas.value = prev ? (prev.notas||"") : "";
    // actualizar UI de √∫ltima actualizaci√≥n e historial (cerrado por defecto)
    if (elHist){ elHist.style.display = "none"; }
    renderUltima(HK_CURRENT_ROOM);
    sillasOverlay.classList.add("activo");
  
  }
  function closeSillas(){
    sillasOverlay.classList.remove("activo");
  }

  btnComenzar && btnComenzar.addEventListener("click", openSillas);
  btnCancelar && btnCancelar.addEventListener("click", closeSillas);
  sillasOverlay && sillasOverlay.addEventListener("click", (e)=>{
    if(e.target === sillasOverlay) closeSillas();
  });

  // Guardar registro
  btnGuardar && btnGuardar.addEventListener("click", ()=>{
    const sess = getSession();
    if(!isActive(sess)){ alert("Sesi√≥n caducada. Inicia sesi√≥n de nuevo."); return; }
    const cantidad = parseInt(inputCant.value || "0", 10);
    const notas = (inputNotas.value || "").trim();

    if(isNaN(cantidad) || cantidad < 0){ alert("Cantidad inv√°lida."); return; }

    const data = loadRoomsData();
    data[HK_CURRENT_ROOM] = data[HK_CURRENT_ROOM] || {};

    const entry = {
      cantidad,
      notas,
      by: sess.matricula,
      nombre: sess.nombre,
      ts: now()
    };

    // historial
    const hist = (data[HK_CURRENT_ROOM].sillas_historial || []);
    hist.push(entry);
    if (hist.length > MAX_HISTORY){ data[HK_CURRENT_ROOM].sillas_historial = hist.slice(hist.length - MAX_HISTORY); }
    else { data[HK_CURRENT_ROOM].sillas_historial = hist; }

    // √∫ltimo
    data[HK_CURRENT_ROOM].sillas = entry;

    saveRoomsData(data);
    audit("save_sillas", { habitacion: HK_CURRENT_ROOM, cantidad });

    // Marca visual
    const btn = document.querySelector(`.habitacion-btn[data-num="${HK_CURRENT_ROOM}"]`);
    if(btn) btn.classList.add("inventario-ok");

    closeSillas();
    // Feedback r√°pido
    const m = document.createElement("div");
    m.className = "mensaje-flotante";
    m.textContent = `Sillas registradas para ${HK_CURRENT_ROOM} ¬∑ ${cantidad}`;
    document.body.appendChild(m);
    setTimeout(()=>{ m.remove(); }, 2000);
  });// Mostrar/ocultar bot√≥n "Comenzar" en base a la sesi√≥n
  function refreshComenzar(){
    const sess = getSession();
    btnComenzar.style.display = isActive(sess) && HK_CURRENT_ROOM ? "inline-flex" : "none";
  }
  setInterval(refreshComenzar, 1000);

  // Tip: si ya tienes otro m√≥dulo de sesi√≥n, este respeta STORAGE_KEY/USERS y reutiliza helpers.
})();
</script>


<script>
(function(){
  // Bot√≥n "Aceptar" del modal de matr√≠cula (si existe)
  const overlayPIN = document.getElementById("hkpin2-overlay");
  const inputPIN = document.getElementById("hkpin2-input");
  const btnOK = document.getElementById("hkpin2-ok");
  if (overlayPIN && inputPIN && btnOK) {
    btnOK.addEventListener("click", function(){
      // Reutiliza la validaci√≥n del m√≥dulo principal si est√° presente
      try {
        // Trigger Enter key behavior programmatically
        const evt = new KeyboardEvent("keydown", {key:"Enter"});
        inputPIN.dispatchEvent(evt);
      } catch(e) {
        // Fallback: setSession si el index integra validateMatricula en window
        const m = (inputPIN.value||"").trim();
        if (window.validateMatricula && window.setSession) {
          if (window.validateMatricula(m)) {
            window.setSession(m);
          }
        }
      }
    });
  }
})();
</script>


<script>
(function(){
  const inp = document.getElementById("hk-sillas-cantidad");
  const dec = document.querySelector(".hk-stepper-dec");
  const inc = document.querySelector(".hk-stepper-inc");
  function clamp(v){
    const min = parseInt(inp.getAttribute("min")||"0",10);
    const max = parseInt(inp.getAttribute("max")||"99",10);
    if (isNaN(v)) v = 0;
    return Math.max(min, Math.min(max, v));
  }
  if (dec) dec.addEventListener("click", ()=>{
    const v = clamp(parseInt(inp.value||"0",10) - 1);
    inp.value = v;
  });
  if (inc) inc.addEventListener("click", ()=>{
    const v = clamp(parseInt(inp.value||"0",10) + 1);
    inp.value = v;
  });
})();
</script>


<button id="hk-logout" class="hk-logout" type="button" aria-label="Cerrar sesi√≥n">Cerrar sesi√≥n</button>

<div id="hk-logout-overlay" class="hk-logout-overlay" role="dialog" aria-modal="true" aria-labelledby="hk-logout-title">
  <div class="hk-logout-modal">
    <h3 id="hk-logout-title">Cerrar sesi√≥n</h3>
    <p>¬øSeguro que deseas cerrar la sesi√≥n actual? Se requerir√° matr√≠cula para volver a ingresar.</p>
    <div class="hk-logout-actions">
      <button type="button" class="hk-logout-btn" id="hk-logout-cancel">Cancelar</button>
      <button type="button" class="hk-logout-btn primary" id="hk-logout-accept">Cerrar sesi√≥n</button>
    </div>
  </div>
</div>


<script>
(function(){
  const STORAGE_KEY = "HK_INV_SESSION_V2";
  const btnLogout = document.getElementById("hk-logout");
  const overlay = document.getElementById("hk-logout-overlay");
  const btnCancel = document.getElementById("hk-logout-cancel");
  const btnAccept = document.getElementById("hk-logout-accept");

  function sessActive(){
    try{
      if (typeof window.getHKSession === "function"){
        return !!window.getHKSession();
      }
      // Fallback: read key directly
      const raw = localStorage.getItem(STORAGE_KEY);
      if (!raw) return false;
      const s = JSON.parse(raw);
      return s && typeof s.expiresAt === "number" && s.expiresAt > Date.now();
    }catch(e){ return false; }
  }

  function showLogout(v){
    if (!btnLogout) return;
    btnLogout.style.display = v ? "inline-flex" : "none";
  }

  function doLogout(){
    try{ localStorage.removeItem(STORAGE_KEY); }catch(e){}
    try{ sessionStorage.removeItem('HK_PIN_OK'); }catch(e){}
    // Oculta controles dependientes de sesi√≥n
    try{
      const btnC = document.getElementById("hk-comenzar");
      if (btnC) btnC.style.display = "none";
    }catch(e){}
    showLogout(false);
    // Mini feedback
    try {
      const m = document.createElement("div");
      m.className = "mensaje-flotante";
      m.textContent = "Sesi√≥n cerrada";
      document.body.appendChild(m);
      setTimeout(()=>{ m.remove(); }, 1800);
    } catch(e){}
  }

  function openConfirm(){ overlay && (overlay.classList.add("activo")); }
  function closeConfirm(){ overlay && (overlay.classList.remove("activo")); }

  // Wire events
  btnLogout && btnLogout.addEventListener("click", openConfirm);
  btnCancel && btnCancel.addEventListener("click", closeConfirm);
  overlay && overlay.addEventListener("click", (e)=>{ if(e.target===overlay) closeConfirm(); });
  btnAccept && btnAccept.addEventListener("click", function(){
    doLogout();
    closeConfirm();
  });

  // Poll to keep visibility in sync (lightweight)
  setInterval(()=>{ showLogout(sessActive()); }, 1000);

  // Also show immediately if already active on load
  showLogout(sessActive());
})();
</script>

</body>
</html>
